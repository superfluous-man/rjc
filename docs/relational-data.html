<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Relational data | R for Data Science (2e)</title>
  <meta name="description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Relational data | R for Data Science (2e)" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://r4ds.had.co.nz/" />
  <meta property="og:image" content="https://r4ds.had.co.nz/cover.png" />
  <meta property="og:description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data." />
  <meta name="github-repo" content="hadley/r4ds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Relational data | R for Data Science (2e)" />
  <meta name="twitter:site" content="@hadley" />
  <meta name="twitter:description" content="This book will teach you how to do data science with R: You’ll learn how to get your data into R, get it into the most useful structure, transform it, visualise it and model it. In this book, you will find a practicum of skills for data science. Just as a chemist learns how to clean test tubes and stock a lab, you’ll learn how to clean data and draw plots—and many other things besides. These are the skills that allow data science to happen, and here you will find the best practices for doing each of these things with R. You’ll learn how to use the grammar of graphics, literate programming, and reproducible research to save time. You’ll also learn how to manage cognitive resources to facilitate discoveries when wrangling, visualising, and exploring data." />
  <meta name="twitter:image" content="https://r4ds.had.co.nz/cover.png" />

<meta name="author" content="Hadley Wickham and Garrett Grolemund" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidy-data.html"/>
<link rel="next" href="strings.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="r4ds.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Data Science</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-you-will-learn"><i class="fa fa-check"></i><b>1.1</b> What you will learn</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#how-this-book-is-organised"><i class="fa fa-check"></i><b>1.2</b> How this book is organised</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-wont-learn"><i class="fa fa-check"></i><b>1.3</b> What you won’t learn</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#big-data"><i class="fa fa-check"></i><b>1.3.1</b> Big data</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#python-julia-and-friends"><i class="fa fa-check"></i><b>1.3.2</b> Python, Julia, and friends</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#non-rectangular-data"><i class="fa fa-check"></i><b>1.3.3</b> Non-rectangular data</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#hypothesis-confirmation"><i class="fa fa-check"></i><b>1.3.4</b> Hypothesis confirmation</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.4</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#r"><i class="fa fa-check"></i><b>1.4.1</b> R</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#rstudio"><i class="fa fa-check"></i><b>1.4.2</b> RStudio</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#the-tidyverse"><i class="fa fa-check"></i><b>1.4.3</b> The tidyverse</a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction.html"><a href="introduction.html#other-packages"><i class="fa fa-check"></i><b>1.4.4</b> Other packages</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#running-r-code"><i class="fa fa-check"></i><b>1.5</b> Running R code</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#getting-help-and-learning-more"><i class="fa fa-check"></i><b>1.6</b> Getting help and learning more</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#acknowledgements-1"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.8</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Explore</b></span></li>
<li class="chapter" data-level="2" data-path="explore-intro.html"><a href="explore-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Data visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-visualisation.html"><a href="data-visualisation.html#prerequisites-1"><i class="fa fa-check"></i><b>3.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#first-steps"><i class="fa fa-check"></i><b>3.2</b> First steps</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-visualisation.html"><a href="data-visualisation.html#the-mpg-data-frame"><i class="fa fa-check"></i><b>3.2.1</b> The <code>mpg</code> data frame</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-visualisation.html"><a href="data-visualisation.html#creating-a-ggplot"><i class="fa fa-check"></i><b>3.2.2</b> Creating a ggplot</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-visualisation.html"><a href="data-visualisation.html#a-graphing-template"><i class="fa fa-check"></i><b>3.2.3</b> A graphing template</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises"><i class="fa fa-check"></i><b>3.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-visualisation.html"><a href="data-visualisation.html#aesthetic-mappings"><i class="fa fa-check"></i><b>3.3</b> Aesthetic mappings</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-visualisation.html"><a href="data-visualisation.html#common-problems"><i class="fa fa-check"></i><b>3.4</b> Common problems</a></li>
<li class="chapter" data-level="3.5" data-path="data-visualisation.html"><a href="data-visualisation.html#facets"><i class="fa fa-check"></i><b>3.5</b> Facets</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-2"><i class="fa fa-check"></i><b>3.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualisation.html"><a href="data-visualisation.html#geometric-objects"><i class="fa fa-check"></i><b>3.6</b> Geometric objects</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-3"><i class="fa fa-check"></i><b>3.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-visualisation.html"><a href="data-visualisation.html#statistical-transformations"><i class="fa fa-check"></i><b>3.7</b> Statistical transformations</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-4"><i class="fa fa-check"></i><b>3.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-visualisation.html"><a href="data-visualisation.html#position-adjustments"><i class="fa fa-check"></i><b>3.8</b> Position adjustments</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-5"><i class="fa fa-check"></i><b>3.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="data-visualisation.html"><a href="data-visualisation.html#coordinate-systems"><i class="fa fa-check"></i><b>3.9</b> Coordinate systems</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-6"><i class="fa fa-check"></i><b>3.9.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-visualisation.html"><a href="data-visualisation.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>3.10</b> The layered grammar of graphics</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow-basics.html"><a href="workflow-basics.html"><i class="fa fa-check"></i><b>4</b> Workflow: basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow-basics.html"><a href="workflow-basics.html#coding-basics"><i class="fa fa-check"></i><b>4.1</b> Coding basics</a></li>
<li class="chapter" data-level="4.2" data-path="workflow-basics.html"><a href="workflow-basics.html#whats-in-a-name"><i class="fa fa-check"></i><b>4.2</b> What’s in a name?</a></li>
<li class="chapter" data-level="4.3" data-path="workflow-basics.html"><a href="workflow-basics.html#calling-functions"><i class="fa fa-check"></i><b>4.3</b> Calling functions</a></li>
<li class="chapter" data-level="4.4" data-path="workflow-basics.html"><a href="workflow-basics.html#exercises-7"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>5</b> Data transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="transform.html"><a href="transform.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="transform.html"><a href="transform.html#prerequisites-2"><i class="fa fa-check"></i><b>5.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.1.2" data-path="transform.html"><a href="transform.html#nycflights13"><i class="fa fa-check"></i><b>5.1.2</b> nycflights13</a></li>
<li class="chapter" data-level="5.1.3" data-path="transform.html"><a href="transform.html#dplyr-basics"><i class="fa fa-check"></i><b>5.1.3</b> dplyr basics</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="transform.html"><a href="transform.html#filter-rows-with-filter"><i class="fa fa-check"></i><b>5.2</b> Filter rows with <code>filter()</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="transform.html"><a href="transform.html#comparisons"><i class="fa fa-check"></i><b>5.2.1</b> Comparisons</a></li>
<li class="chapter" data-level="5.2.2" data-path="transform.html"><a href="transform.html#logical-operators"><i class="fa fa-check"></i><b>5.2.2</b> Logical operators</a></li>
<li class="chapter" data-level="5.2.3" data-path="transform.html"><a href="transform.html#missing-values"><i class="fa fa-check"></i><b>5.2.3</b> Missing values</a></li>
<li class="chapter" data-level="5.2.4" data-path="transform.html"><a href="transform.html#exercises-8"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="transform.html"><a href="transform.html#arrange-rows-with-arrange"><i class="fa fa-check"></i><b>5.3</b> Arrange rows with <code>arrange()</code></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="transform.html"><a href="transform.html#exercises-9"><i class="fa fa-check"></i><b>5.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="transform.html"><a href="transform.html#select"><i class="fa fa-check"></i><b>5.4</b> Select columns with <code>select()</code></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="transform.html"><a href="transform.html#exercises-10"><i class="fa fa-check"></i><b>5.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="transform.html"><a href="transform.html#add-new-variables-with-mutate"><i class="fa fa-check"></i><b>5.5</b> Add new variables with <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="transform.html"><a href="transform.html#mutate-funs"><i class="fa fa-check"></i><b>5.5.1</b> Useful creation functions</a></li>
<li class="chapter" data-level="5.5.2" data-path="transform.html"><a href="transform.html#exercises-11"><i class="fa fa-check"></i><b>5.5.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="transform.html"><a href="transform.html#grouped-summaries-with-summarise"><i class="fa fa-check"></i><b>5.6</b> Grouped summaries with <code>summarise()</code></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="transform.html"><a href="transform.html#combining-multiple-operations-with-the-pipe"><i class="fa fa-check"></i><b>5.6.1</b> Combining multiple operations with the pipe</a></li>
<li class="chapter" data-level="5.6.2" data-path="transform.html"><a href="transform.html#missing-values-1"><i class="fa fa-check"></i><b>5.6.2</b> Missing values</a></li>
<li class="chapter" data-level="5.6.3" data-path="transform.html"><a href="transform.html#counts"><i class="fa fa-check"></i><b>5.6.3</b> Counts</a></li>
<li class="chapter" data-level="5.6.4" data-path="transform.html"><a href="transform.html#summarise-funs"><i class="fa fa-check"></i><b>5.6.4</b> Useful summary functions</a></li>
<li class="chapter" data-level="5.6.5" data-path="transform.html"><a href="transform.html#grouping-by-multiple-variables"><i class="fa fa-check"></i><b>5.6.5</b> Grouping by multiple variables</a></li>
<li class="chapter" data-level="5.6.6" data-path="transform.html"><a href="transform.html#ungrouping"><i class="fa fa-check"></i><b>5.6.6</b> Ungrouping</a></li>
<li class="chapter" data-level="5.6.7" data-path="transform.html"><a href="transform.html#exercises-12"><i class="fa fa-check"></i><b>5.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="transform.html"><a href="transform.html#grouped-mutates-and-filters"><i class="fa fa-check"></i><b>5.7</b> Grouped mutates (and filters)</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="transform.html"><a href="transform.html#exercises-13"><i class="fa fa-check"></i><b>5.7.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="workflow-scripts.html"><a href="workflow-scripts.html"><i class="fa fa-check"></i><b>6</b> Workflow: scripts</a>
<ul>
<li class="chapter" data-level="6.1" data-path="workflow-scripts.html"><a href="workflow-scripts.html#running-code"><i class="fa fa-check"></i><b>6.1</b> Running code</a></li>
<li class="chapter" data-level="6.2" data-path="workflow-scripts.html"><a href="workflow-scripts.html#rstudio-diagnostics"><i class="fa fa-check"></i><b>6.2</b> RStudio diagnostics</a></li>
<li class="chapter" data-level="6.3" data-path="workflow-scripts.html"><a href="workflow-scripts.html#exercises-14"><i class="fa fa-check"></i><b>6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>7</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#prerequisites-3"><i class="fa fa-check"></i><b>7.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#questions"><i class="fa fa-check"></i><b>7.2</b> Questions</a></li>
<li class="chapter" data-level="7.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#variation"><i class="fa fa-check"></i><b>7.3</b> Variation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#visualising-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Visualising distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#typical-values"><i class="fa fa-check"></i><b>7.3.2</b> Typical values</a></li>
<li class="chapter" data-level="7.3.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#unusual-values"><i class="fa fa-check"></i><b>7.3.3</b> Unusual values</a></li>
<li class="chapter" data-level="7.3.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-15"><i class="fa fa-check"></i><b>7.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#missing-values-2"><i class="fa fa-check"></i><b>7.4</b> Missing values</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exercises-16"><i class="fa fa-check"></i><b>7.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#covariation"><i class="fa fa-check"></i><b>7.5</b> Covariation</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#cat-cont"><i class="fa fa-check"></i><b>7.5.1</b> A categorical and continuous variable</a></li>
<li class="chapter" data-level="7.5.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#two-categorical-variables"><i class="fa fa-check"></i><b>7.5.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="7.5.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#two-continuous-variables"><i class="fa fa-check"></i><b>7.5.3</b> Two continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#patterns-and-models"><i class="fa fa-check"></i><b>7.6</b> Patterns and models</a></li>
<li class="chapter" data-level="7.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#ggplot2-calls"><i class="fa fa-check"></i><b>7.7</b> ggplot2 calls</a></li>
<li class="chapter" data-level="7.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#learning-more"><i class="fa fa-check"></i><b>7.8</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="workflow-projects.html"><a href="workflow-projects.html"><i class="fa fa-check"></i><b>8</b> Workflow: projects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="workflow-projects.html"><a href="workflow-projects.html#what-is-real"><i class="fa fa-check"></i><b>8.1</b> What is real?</a></li>
<li class="chapter" data-level="8.2" data-path="workflow-projects.html"><a href="workflow-projects.html#where-does-your-analysis-live"><i class="fa fa-check"></i><b>8.2</b> Where does your analysis live?</a></li>
<li class="chapter" data-level="8.3" data-path="workflow-projects.html"><a href="workflow-projects.html#paths-and-directories"><i class="fa fa-check"></i><b>8.3</b> Paths and directories</a></li>
<li class="chapter" data-level="8.4" data-path="workflow-projects.html"><a href="workflow-projects.html#rstudio-projects"><i class="fa fa-check"></i><b>8.4</b> RStudio projects</a></li>
<li class="chapter" data-level="8.5" data-path="workflow-projects.html"><a href="workflow-projects.html#summary"><i class="fa fa-check"></i><b>8.5</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>II Wrangle</b></span></li>
<li class="chapter" data-level="9" data-path="wrangle-intro.html"><a href="wrangle-intro.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="tibbles.html"><a href="tibbles.html"><i class="fa fa-check"></i><b>10</b> Tibbles</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tibbles.html"><a href="tibbles.html#introduction-4"><i class="fa fa-check"></i><b>10.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="tibbles.html"><a href="tibbles.html#prerequisites-4"><i class="fa fa-check"></i><b>10.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="tibbles.html"><a href="tibbles.html#creating-tibbles"><i class="fa fa-check"></i><b>10.2</b> Creating tibbles</a></li>
<li class="chapter" data-level="10.3" data-path="tibbles.html"><a href="tibbles.html#tibbles-vs.-data.frame"><i class="fa fa-check"></i><b>10.3</b> Tibbles vs. data.frame</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="tibbles.html"><a href="tibbles.html#printing"><i class="fa fa-check"></i><b>10.3.1</b> Printing</a></li>
<li class="chapter" data-level="10.3.2" data-path="tibbles.html"><a href="tibbles.html#subsetting"><i class="fa fa-check"></i><b>10.3.2</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="tibbles.html"><a href="tibbles.html#interacting-with-older-code"><i class="fa fa-check"></i><b>10.4</b> Interacting with older code</a></li>
<li class="chapter" data-level="10.5" data-path="tibbles.html"><a href="tibbles.html#exercises-20"><i class="fa fa-check"></i><b>10.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>11</b> Data import</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-import.html"><a href="data-import.html#introduction-5"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-import.html"><a href="data-import.html#prerequisites-5"><i class="fa fa-check"></i><b>11.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="data-import.html"><a href="data-import.html#getting-started"><i class="fa fa-check"></i><b>11.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="data-import.html"><a href="data-import.html#compared-to-base-r"><i class="fa fa-check"></i><b>11.2.1</b> Compared to base R</a></li>
<li class="chapter" data-level="11.2.2" data-path="data-import.html"><a href="data-import.html#exercises-21"><i class="fa fa-check"></i><b>11.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="data-import.html"><a href="data-import.html#parsing-a-vector"><i class="fa fa-check"></i><b>11.3</b> Parsing a vector</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="data-import.html"><a href="data-import.html#numbers"><i class="fa fa-check"></i><b>11.3.1</b> Numbers</a></li>
<li class="chapter" data-level="11.3.2" data-path="data-import.html"><a href="data-import.html#readr-strings"><i class="fa fa-check"></i><b>11.3.2</b> Strings</a></li>
<li class="chapter" data-level="11.3.3" data-path="data-import.html"><a href="data-import.html#readr-factors"><i class="fa fa-check"></i><b>11.3.3</b> Factors</a></li>
<li class="chapter" data-level="11.3.4" data-path="data-import.html"><a href="data-import.html#readr-datetimes"><i class="fa fa-check"></i><b>11.3.4</b> Dates, date-times, and times</a></li>
<li class="chapter" data-level="11.3.5" data-path="data-import.html"><a href="data-import.html#exercises-22"><i class="fa fa-check"></i><b>11.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="data-import.html"><a href="data-import.html#parsing-a-file"><i class="fa fa-check"></i><b>11.4</b> Parsing a file</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="data-import.html"><a href="data-import.html#strategy"><i class="fa fa-check"></i><b>11.4.1</b> Strategy</a></li>
<li class="chapter" data-level="11.4.2" data-path="data-import.html"><a href="data-import.html#problems"><i class="fa fa-check"></i><b>11.4.2</b> Problems</a></li>
<li class="chapter" data-level="11.4.3" data-path="data-import.html"><a href="data-import.html#other-strategies"><i class="fa fa-check"></i><b>11.4.3</b> Other strategies</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="data-import.html"><a href="data-import.html#writing-to-a-file"><i class="fa fa-check"></i><b>11.5</b> Writing to a file</a></li>
<li class="chapter" data-level="11.6" data-path="data-import.html"><a href="data-import.html#other-types-of-data"><i class="fa fa-check"></i><b>11.6</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>12</b> Tidy data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="tidy-data.html"><a href="tidy-data.html#introduction-6"><i class="fa fa-check"></i><b>12.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="tidy-data.html"><a href="tidy-data.html#prerequisites-6"><i class="fa fa-check"></i><b>12.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>12.2</b> Tidy data</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="tidy-data.html"><a href="tidy-data.html#exercises-23"><i class="fa fa-check"></i><b>12.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="tidy-data.html"><a href="tidy-data.html#pivoting"><i class="fa fa-check"></i><b>12.3</b> Pivoting</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="tidy-data.html"><a href="tidy-data.html#longer"><i class="fa fa-check"></i><b>12.3.1</b> Longer</a></li>
<li class="chapter" data-level="12.3.2" data-path="tidy-data.html"><a href="tidy-data.html#wider"><i class="fa fa-check"></i><b>12.3.2</b> Wider</a></li>
<li class="chapter" data-level="12.3.3" data-path="tidy-data.html"><a href="tidy-data.html#exercises-24"><i class="fa fa-check"></i><b>12.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="tidy-data.html"><a href="tidy-data.html#separating"><i class="fa fa-check"></i><b>12.4</b> Separating</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="tidy-data.html"><a href="tidy-data.html#separate"><i class="fa fa-check"></i><b>12.4.1</b> Separate</a></li>
<li class="chapter" data-level="12.4.2" data-path="tidy-data.html"><a href="tidy-data.html#unite"><i class="fa fa-check"></i><b>12.4.2</b> Unite</a></li>
<li class="chapter" data-level="12.4.3" data-path="tidy-data.html"><a href="tidy-data.html#exercises-25"><i class="fa fa-check"></i><b>12.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="tidy-data.html"><a href="tidy-data.html#missing-values-3"><i class="fa fa-check"></i><b>12.5</b> Missing values</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="tidy-data.html"><a href="tidy-data.html#exercises-26"><i class="fa fa-check"></i><b>12.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="tidy-data.html"><a href="tidy-data.html#case-study"><i class="fa fa-check"></i><b>12.6</b> Case study</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="tidy-data.html"><a href="tidy-data.html#exercises-27"><i class="fa fa-check"></i><b>12.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="tidy-data.html"><a href="tidy-data.html#non-tidy-data"><i class="fa fa-check"></i><b>12.7</b> Non-tidy data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>13</b> Relational data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="relational-data.html"><a href="relational-data.html#introduction-7"><i class="fa fa-check"></i><b>13.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="relational-data.html"><a href="relational-data.html#prerequisites-7"><i class="fa fa-check"></i><b>13.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="relational-data.html"><a href="relational-data.html#nycflights13-relational"><i class="fa fa-check"></i><b>13.2</b> nycflights13</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="relational-data.html"><a href="relational-data.html#exercises-28"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="relational-data.html"><a href="relational-data.html#keys"><i class="fa fa-check"></i><b>13.3</b> Keys</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="relational-data.html"><a href="relational-data.html#exercises-29"><i class="fa fa-check"></i><b>13.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="relational-data.html"><a href="relational-data.html#mutating-joins"><i class="fa fa-check"></i><b>13.4</b> Mutating joins</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="relational-data.html"><a href="relational-data.html#understanding-joins"><i class="fa fa-check"></i><b>13.4.1</b> Understanding joins</a></li>
<li class="chapter" data-level="13.4.2" data-path="relational-data.html"><a href="relational-data.html#inner-join"><i class="fa fa-check"></i><b>13.4.2</b> Inner join</a></li>
<li class="chapter" data-level="13.4.3" data-path="relational-data.html"><a href="relational-data.html#outer-join"><i class="fa fa-check"></i><b>13.4.3</b> Outer joins</a></li>
<li class="chapter" data-level="13.4.4" data-path="relational-data.html"><a href="relational-data.html#join-matches"><i class="fa fa-check"></i><b>13.4.4</b> Duplicate keys</a></li>
<li class="chapter" data-level="13.4.5" data-path="relational-data.html"><a href="relational-data.html#join-by"><i class="fa fa-check"></i><b>13.4.5</b> Defining the key columns</a></li>
<li class="chapter" data-level="13.4.6" data-path="relational-data.html"><a href="relational-data.html#exercises-30"><i class="fa fa-check"></i><b>13.4.6</b> Exercises</a></li>
<li class="chapter" data-level="13.4.7" data-path="relational-data.html"><a href="relational-data.html#other-implementations"><i class="fa fa-check"></i><b>13.4.7</b> Other implementations</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="relational-data.html"><a href="relational-data.html#filtering-joins"><i class="fa fa-check"></i><b>13.5</b> Filtering joins</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="relational-data.html"><a href="relational-data.html#exercises-31"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="relational-data.html"><a href="relational-data.html#join-problems"><i class="fa fa-check"></i><b>13.6</b> Join problems</a></li>
<li class="chapter" data-level="13.7" data-path="relational-data.html"><a href="relational-data.html#set-operations"><i class="fa fa-check"></i><b>13.7</b> Set operations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>14</b> Strings</a>
<ul>
<li class="chapter" data-level="14.1" data-path="strings.html"><a href="strings.html#introduction-8"><i class="fa fa-check"></i><b>14.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="strings.html"><a href="strings.html#prerequisites-8"><i class="fa fa-check"></i><b>14.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="strings.html"><a href="strings.html#string-basics"><i class="fa fa-check"></i><b>14.2</b> String basics</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="strings.html"><a href="strings.html#string-length"><i class="fa fa-check"></i><b>14.2.1</b> String length</a></li>
<li class="chapter" data-level="14.2.2" data-path="strings.html"><a href="strings.html#combining-strings"><i class="fa fa-check"></i><b>14.2.2</b> Combining strings</a></li>
<li class="chapter" data-level="14.2.3" data-path="strings.html"><a href="strings.html#subsetting-strings"><i class="fa fa-check"></i><b>14.2.3</b> Subsetting strings</a></li>
<li class="chapter" data-level="14.2.4" data-path="strings.html"><a href="strings.html#locales"><i class="fa fa-check"></i><b>14.2.4</b> Locales</a></li>
<li class="chapter" data-level="14.2.5" data-path="strings.html"><a href="strings.html#exercises-32"><i class="fa fa-check"></i><b>14.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="strings.html"><a href="strings.html#matching-patterns-with-regular-expressions"><i class="fa fa-check"></i><b>14.3</b> Matching patterns with regular expressions</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="strings.html"><a href="strings.html#basic-matches"><i class="fa fa-check"></i><b>14.3.1</b> Basic matches</a></li>
<li class="chapter" data-level="14.3.2" data-path="strings.html"><a href="strings.html#anchors"><i class="fa fa-check"></i><b>14.3.2</b> Anchors</a></li>
<li class="chapter" data-level="14.3.3" data-path="strings.html"><a href="strings.html#character-classes-and-alternatives"><i class="fa fa-check"></i><b>14.3.3</b> Character classes and alternatives</a></li>
<li class="chapter" data-level="14.3.4" data-path="strings.html"><a href="strings.html#repetition"><i class="fa fa-check"></i><b>14.3.4</b> Repetition</a></li>
<li class="chapter" data-level="14.3.5" data-path="strings.html"><a href="strings.html#grouping-and-backreferences"><i class="fa fa-check"></i><b>14.3.5</b> Grouping and backreferences</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="strings.html"><a href="strings.html#tools"><i class="fa fa-check"></i><b>14.4</b> Tools</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="strings.html"><a href="strings.html#detect-matches"><i class="fa fa-check"></i><b>14.4.1</b> Detect matches</a></li>
<li class="chapter" data-level="14.4.2" data-path="strings.html"><a href="strings.html#extract-matches"><i class="fa fa-check"></i><b>14.4.2</b> Extract matches</a></li>
<li class="chapter" data-level="14.4.3" data-path="strings.html"><a href="strings.html#grouped-matches"><i class="fa fa-check"></i><b>14.4.3</b> Grouped matches</a></li>
<li class="chapter" data-level="14.4.4" data-path="strings.html"><a href="strings.html#replacing-matches"><i class="fa fa-check"></i><b>14.4.4</b> Replacing matches</a></li>
<li class="chapter" data-level="14.4.5" data-path="strings.html"><a href="strings.html#splitting"><i class="fa fa-check"></i><b>14.4.5</b> Splitting</a></li>
<li class="chapter" data-level="14.4.6" data-path="strings.html"><a href="strings.html#find-matches"><i class="fa fa-check"></i><b>14.4.6</b> Find matches</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="strings.html"><a href="strings.html#other-types-of-pattern"><i class="fa fa-check"></i><b>14.5</b> Other types of pattern</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="strings.html"><a href="strings.html#exercises-43"><i class="fa fa-check"></i><b>14.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="strings.html"><a href="strings.html#other-uses-of-regular-expressions"><i class="fa fa-check"></i><b>14.6</b> Other uses of regular expressions</a></li>
<li class="chapter" data-level="14.7" data-path="strings.html"><a href="strings.html#stringi"><i class="fa fa-check"></i><b>14.7</b> stringi</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="strings.html"><a href="strings.html#exercises-44"><i class="fa fa-check"></i><b>14.7.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>15</b> Factors</a>
<ul>
<li class="chapter" data-level="15.1" data-path="factors.html"><a href="factors.html#introduction-9"><i class="fa fa-check"></i><b>15.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="factors.html"><a href="factors.html#prerequisites-9"><i class="fa fa-check"></i><b>15.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="15.1.2" data-path="factors.html"><a href="factors.html#learning-more-1"><i class="fa fa-check"></i><b>15.1.2</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="factors.html"><a href="factors.html#creating-factors"><i class="fa fa-check"></i><b>15.2</b> Creating factors</a></li>
<li class="chapter" data-level="15.3" data-path="factors.html"><a href="factors.html#general-social-survey"><i class="fa fa-check"></i><b>15.3</b> General Social Survey</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="factors.html"><a href="factors.html#exercise"><i class="fa fa-check"></i><b>15.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="factors.html"><a href="factors.html#modifying-factor-order"><i class="fa fa-check"></i><b>15.4</b> Modifying factor order</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="factors.html"><a href="factors.html#exercises-45"><i class="fa fa-check"></i><b>15.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="factors.html"><a href="factors.html#modifying-factor-levels"><i class="fa fa-check"></i><b>15.5</b> Modifying factor levels</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="factors.html"><a href="factors.html#exercises-46"><i class="fa fa-check"></i><b>15.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>16</b> Dates and times</a>
<ul>
<li class="chapter" data-level="16.1" data-path="dates-and-times.html"><a href="dates-and-times.html#introduction-10"><i class="fa fa-check"></i><b>16.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="dates-and-times.html"><a href="dates-and-times.html#prerequisites-10"><i class="fa fa-check"></i><b>16.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="dates-and-times.html"><a href="dates-and-times.html#creating-datetimes"><i class="fa fa-check"></i><b>16.2</b> Creating date/times</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="dates-and-times.html"><a href="dates-and-times.html#from-strings"><i class="fa fa-check"></i><b>16.2.1</b> From strings</a></li>
<li class="chapter" data-level="16.2.2" data-path="dates-and-times.html"><a href="dates-and-times.html#from-individual-components"><i class="fa fa-check"></i><b>16.2.2</b> From individual components</a></li>
<li class="chapter" data-level="16.2.3" data-path="dates-and-times.html"><a href="dates-and-times.html#from-other-types"><i class="fa fa-check"></i><b>16.2.3</b> From other types</a></li>
<li class="chapter" data-level="16.2.4" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises-47"><i class="fa fa-check"></i><b>16.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="dates-and-times.html"><a href="dates-and-times.html#date-time-components"><i class="fa fa-check"></i><b>16.3</b> Date-time components</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="dates-and-times.html"><a href="dates-and-times.html#getting-components"><i class="fa fa-check"></i><b>16.3.1</b> Getting components</a></li>
<li class="chapter" data-level="16.3.2" data-path="dates-and-times.html"><a href="dates-and-times.html#rounding"><i class="fa fa-check"></i><b>16.3.2</b> Rounding</a></li>
<li class="chapter" data-level="16.3.3" data-path="dates-and-times.html"><a href="dates-and-times.html#setting-components"><i class="fa fa-check"></i><b>16.3.3</b> Setting components</a></li>
<li class="chapter" data-level="16.3.4" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises-48"><i class="fa fa-check"></i><b>16.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="dates-and-times.html"><a href="dates-and-times.html#time-spans"><i class="fa fa-check"></i><b>16.4</b> Time spans</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="dates-and-times.html"><a href="dates-and-times.html#durations"><i class="fa fa-check"></i><b>16.4.1</b> Durations</a></li>
<li class="chapter" data-level="16.4.2" data-path="dates-and-times.html"><a href="dates-and-times.html#periods"><i class="fa fa-check"></i><b>16.4.2</b> Periods</a></li>
<li class="chapter" data-level="16.4.3" data-path="dates-and-times.html"><a href="dates-and-times.html#intervals"><i class="fa fa-check"></i><b>16.4.3</b> Intervals</a></li>
<li class="chapter" data-level="16.4.4" data-path="dates-and-times.html"><a href="dates-and-times.html#summary-1"><i class="fa fa-check"></i><b>16.4.4</b> Summary</a></li>
<li class="chapter" data-level="16.4.5" data-path="dates-and-times.html"><a href="dates-and-times.html#exercises-49"><i class="fa fa-check"></i><b>16.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="dates-and-times.html"><a href="dates-and-times.html#time-zones"><i class="fa fa-check"></i><b>16.5</b> Time zones</a></li>
</ul></li>
<li class="part"><span><b>III Program</b></span></li>
<li class="chapter" data-level="17" data-path="program-intro.html"><a href="program-intro.html"><i class="fa fa-check"></i><b>17</b> Introduction</a>
<ul>
<li class="chapter" data-level="17.1" data-path="program-intro.html"><a href="program-intro.html#learning-more-2"><i class="fa fa-check"></i><b>17.1</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i><b>18</b> Pipes</a>
<ul>
<li class="chapter" data-level="18.1" data-path="pipes.html"><a href="pipes.html#introduction-11"><i class="fa fa-check"></i><b>18.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="pipes.html"><a href="pipes.html#prerequisites-11"><i class="fa fa-check"></i><b>18.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="pipes.html"><a href="pipes.html#piping-alternatives"><i class="fa fa-check"></i><b>18.2</b> Piping alternatives</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="pipes.html"><a href="pipes.html#intermediate-steps"><i class="fa fa-check"></i><b>18.2.1</b> Intermediate steps</a></li>
<li class="chapter" data-level="18.2.2" data-path="pipes.html"><a href="pipes.html#overwrite-the-original"><i class="fa fa-check"></i><b>18.2.2</b> Overwrite the original</a></li>
<li class="chapter" data-level="18.2.3" data-path="pipes.html"><a href="pipes.html#function-composition"><i class="fa fa-check"></i><b>18.2.3</b> Function composition</a></li>
<li class="chapter" data-level="18.2.4" data-path="pipes.html"><a href="pipes.html#use-the-pipe"><i class="fa fa-check"></i><b>18.2.4</b> Use the pipe</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="pipes.html"><a href="pipes.html#when-not-to-use-the-pipe"><i class="fa fa-check"></i><b>18.3</b> When not to use the pipe</a></li>
<li class="chapter" data-level="18.4" data-path="pipes.html"><a href="pipes.html#other-tools-from-magrittr"><i class="fa fa-check"></i><b>18.4</b> Other tools from magrittr</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>19</b> Functions</a>
<ul>
<li class="chapter" data-level="19.1" data-path="functions.html"><a href="functions.html#introduction-12"><i class="fa fa-check"></i><b>19.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="functions.html"><a href="functions.html#prerequisites-12"><i class="fa fa-check"></i><b>19.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="functions.html"><a href="functions.html#when-should-you-write-a-function"><i class="fa fa-check"></i><b>19.2</b> When should you write a function?</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="functions.html"><a href="functions.html#exercises-50"><i class="fa fa-check"></i><b>19.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="functions.html"><a href="functions.html#functions-are-for-humans-and-computers"><i class="fa fa-check"></i><b>19.3</b> Functions are for humans and computers</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="functions.html"><a href="functions.html#exercises-51"><i class="fa fa-check"></i><b>19.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="functions.html"><a href="functions.html#conditional-execution"><i class="fa fa-check"></i><b>19.4</b> Conditional execution</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="functions.html"><a href="functions.html#conditions"><i class="fa fa-check"></i><b>19.4.1</b> Conditions</a></li>
<li class="chapter" data-level="19.4.2" data-path="functions.html"><a href="functions.html#multiple-conditions"><i class="fa fa-check"></i><b>19.4.2</b> Multiple conditions</a></li>
<li class="chapter" data-level="19.4.3" data-path="functions.html"><a href="functions.html#code-style"><i class="fa fa-check"></i><b>19.4.3</b> Code style</a></li>
<li class="chapter" data-level="19.4.4" data-path="functions.html"><a href="functions.html#exercises-52"><i class="fa fa-check"></i><b>19.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="functions.html"><a href="functions.html#function-arguments"><i class="fa fa-check"></i><b>19.5</b> Function arguments</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="functions.html"><a href="functions.html#choosing-names"><i class="fa fa-check"></i><b>19.5.1</b> Choosing names</a></li>
<li class="chapter" data-level="19.5.2" data-path="functions.html"><a href="functions.html#checking-values"><i class="fa fa-check"></i><b>19.5.2</b> Checking values</a></li>
<li class="chapter" data-level="19.5.3" data-path="functions.html"><a href="functions.html#dot-dot-dot"><i class="fa fa-check"></i><b>19.5.3</b> Dot-dot-dot (…)</a></li>
<li class="chapter" data-level="19.5.4" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>19.5.4</b> Lazy evaluation</a></li>
<li class="chapter" data-level="19.5.5" data-path="functions.html"><a href="functions.html#exercises-53"><i class="fa fa-check"></i><b>19.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="functions.html"><a href="functions.html#return-values"><i class="fa fa-check"></i><b>19.6</b> Return values</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="functions.html"><a href="functions.html#explicit-return-statements"><i class="fa fa-check"></i><b>19.6.1</b> Explicit return statements</a></li>
<li class="chapter" data-level="19.6.2" data-path="functions.html"><a href="functions.html#writing-pipeable-functions"><i class="fa fa-check"></i><b>19.6.2</b> Writing pipeable functions</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="functions.html"><a href="functions.html#environment"><i class="fa fa-check"></i><b>19.7</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>20</b> Vectors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="vectors.html"><a href="vectors.html#introduction-13"><i class="fa fa-check"></i><b>20.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="vectors.html"><a href="vectors.html#prerequisites-13"><i class="fa fa-check"></i><b>20.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="vectors.html"><a href="vectors.html#vector-basics"><i class="fa fa-check"></i><b>20.2</b> Vector basics</a></li>
<li class="chapter" data-level="20.3" data-path="vectors.html"><a href="vectors.html#important-types-of-atomic-vector"><i class="fa fa-check"></i><b>20.3</b> Important types of atomic vector</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="vectors.html"><a href="vectors.html#logical"><i class="fa fa-check"></i><b>20.3.1</b> Logical</a></li>
<li class="chapter" data-level="20.3.2" data-path="vectors.html"><a href="vectors.html#numeric"><i class="fa fa-check"></i><b>20.3.2</b> Numeric</a></li>
<li class="chapter" data-level="20.3.3" data-path="vectors.html"><a href="vectors.html#character"><i class="fa fa-check"></i><b>20.3.3</b> Character</a></li>
<li class="chapter" data-level="20.3.4" data-path="vectors.html"><a href="vectors.html#missing-values-4"><i class="fa fa-check"></i><b>20.3.4</b> Missing values</a></li>
<li class="chapter" data-level="20.3.5" data-path="vectors.html"><a href="vectors.html#exercises-54"><i class="fa fa-check"></i><b>20.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="vectors.html"><a href="vectors.html#using-atomic-vectors"><i class="fa fa-check"></i><b>20.4</b> Using atomic vectors</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="vectors.html"><a href="vectors.html#coercion"><i class="fa fa-check"></i><b>20.4.1</b> Coercion</a></li>
<li class="chapter" data-level="20.4.2" data-path="vectors.html"><a href="vectors.html#test-functions"><i class="fa fa-check"></i><b>20.4.2</b> Test functions</a></li>
<li class="chapter" data-level="20.4.3" data-path="vectors.html"><a href="vectors.html#scalars-and-recycling-rules"><i class="fa fa-check"></i><b>20.4.3</b> Scalars and recycling rules</a></li>
<li class="chapter" data-level="20.4.4" data-path="vectors.html"><a href="vectors.html#naming-vectors"><i class="fa fa-check"></i><b>20.4.4</b> Naming vectors</a></li>
<li class="chapter" data-level="20.4.5" data-path="vectors.html"><a href="vectors.html#vector-subsetting"><i class="fa fa-check"></i><b>20.4.5</b> Subsetting</a></li>
<li class="chapter" data-level="20.4.6" data-path="vectors.html"><a href="vectors.html#exercises-55"><i class="fa fa-check"></i><b>20.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="vectors.html"><a href="vectors.html#lists"><i class="fa fa-check"></i><b>20.5</b> Recursive vectors (lists)</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="vectors.html"><a href="vectors.html#visualising-lists"><i class="fa fa-check"></i><b>20.5.1</b> Visualising lists</a></li>
<li class="chapter" data-level="20.5.2" data-path="vectors.html"><a href="vectors.html#subsetting-1"><i class="fa fa-check"></i><b>20.5.2</b> Subsetting</a></li>
<li class="chapter" data-level="20.5.3" data-path="vectors.html"><a href="vectors.html#lists-of-condiments"><i class="fa fa-check"></i><b>20.5.3</b> Lists of condiments</a></li>
<li class="chapter" data-level="20.5.4" data-path="vectors.html"><a href="vectors.html#exercises-56"><i class="fa fa-check"></i><b>20.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="vectors.html"><a href="vectors.html#attributes"><i class="fa fa-check"></i><b>20.6</b> Attributes</a></li>
<li class="chapter" data-level="20.7" data-path="vectors.html"><a href="vectors.html#augmented-vectors"><i class="fa fa-check"></i><b>20.7</b> Augmented vectors</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="vectors.html"><a href="vectors.html#factors-1"><i class="fa fa-check"></i><b>20.7.1</b> Factors</a></li>
<li class="chapter" data-level="20.7.2" data-path="vectors.html"><a href="vectors.html#dates-and-date-times"><i class="fa fa-check"></i><b>20.7.2</b> Dates and date-times</a></li>
<li class="chapter" data-level="20.7.3" data-path="vectors.html"><a href="vectors.html#tibbles-1"><i class="fa fa-check"></i><b>20.7.3</b> Tibbles</a></li>
<li class="chapter" data-level="20.7.4" data-path="vectors.html"><a href="vectors.html#exercises-57"><i class="fa fa-check"></i><b>20.7.4</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>21</b> Iteration</a>
<ul>
<li class="chapter" data-level="21.1" data-path="iteration.html"><a href="iteration.html#introduction-14"><i class="fa fa-check"></i><b>21.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="iteration.html"><a href="iteration.html#prerequisites-14"><i class="fa fa-check"></i><b>21.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="iteration.html"><a href="iteration.html#for-loops"><i class="fa fa-check"></i><b>21.2</b> For loops</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="iteration.html"><a href="iteration.html#exercises-58"><i class="fa fa-check"></i><b>21.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="iteration.html"><a href="iteration.html#for-loop-variations"><i class="fa fa-check"></i><b>21.3</b> For loop variations</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="iteration.html"><a href="iteration.html#modifying-an-existing-object"><i class="fa fa-check"></i><b>21.3.1</b> Modifying an existing object</a></li>
<li class="chapter" data-level="21.3.2" data-path="iteration.html"><a href="iteration.html#looping-patterns"><i class="fa fa-check"></i><b>21.3.2</b> Looping patterns</a></li>
<li class="chapter" data-level="21.3.3" data-path="iteration.html"><a href="iteration.html#unknown-output-length"><i class="fa fa-check"></i><b>21.3.3</b> Unknown output length</a></li>
<li class="chapter" data-level="21.3.4" data-path="iteration.html"><a href="iteration.html#unknown-sequence-length"><i class="fa fa-check"></i><b>21.3.4</b> Unknown sequence length</a></li>
<li class="chapter" data-level="21.3.5" data-path="iteration.html"><a href="iteration.html#exercises-59"><i class="fa fa-check"></i><b>21.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="iteration.html"><a href="iteration.html#for-loops-vs.-functionals"><i class="fa fa-check"></i><b>21.4</b> For loops vs. functionals</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="iteration.html"><a href="iteration.html#exercises-60"><i class="fa fa-check"></i><b>21.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="iteration.html"><a href="iteration.html#the-map-functions"><i class="fa fa-check"></i><b>21.5</b> The map functions</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="iteration.html"><a href="iteration.html#shortcuts"><i class="fa fa-check"></i><b>21.5.1</b> Shortcuts</a></li>
<li class="chapter" data-level="21.5.2" data-path="iteration.html"><a href="iteration.html#base-r"><i class="fa fa-check"></i><b>21.5.2</b> Base R</a></li>
<li class="chapter" data-level="21.5.3" data-path="iteration.html"><a href="iteration.html#exercises-61"><i class="fa fa-check"></i><b>21.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="iteration.html"><a href="iteration.html#dealing-with-failure"><i class="fa fa-check"></i><b>21.6</b> Dealing with failure</a></li>
<li class="chapter" data-level="21.7" data-path="iteration.html"><a href="iteration.html#mapping-over-multiple-arguments"><i class="fa fa-check"></i><b>21.7</b> Mapping over multiple arguments</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="iteration.html"><a href="iteration.html#invoking-different-functions"><i class="fa fa-check"></i><b>21.7.1</b> Invoking different functions</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="iteration.html"><a href="iteration.html#walk"><i class="fa fa-check"></i><b>21.8</b> Walk</a></li>
<li class="chapter" data-level="21.9" data-path="iteration.html"><a href="iteration.html#other-patterns-of-for-loops"><i class="fa fa-check"></i><b>21.9</b> Other patterns of for loops</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="iteration.html"><a href="iteration.html#predicate-functions"><i class="fa fa-check"></i><b>21.9.1</b> Predicate functions</a></li>
<li class="chapter" data-level="21.9.2" data-path="iteration.html"><a href="iteration.html#reduce-and-accumulate"><i class="fa fa-check"></i><b>21.9.2</b> Reduce and accumulate</a></li>
<li class="chapter" data-level="21.9.3" data-path="iteration.html"><a href="iteration.html#exercises-62"><i class="fa fa-check"></i><b>21.9.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Model</b></span></li>
<li class="chapter" data-level="22" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>22</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1" data-path="model-intro.html"><a href="model-intro.html#hypothesis-generation-vs.-hypothesis-confirmation"><i class="fa fa-check"></i><b>22.1</b> Hypothesis generation vs. hypothesis confirmation</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="model-basics.html"><a href="model-basics.html"><i class="fa fa-check"></i><b>23</b> Model basics</a>
<ul>
<li class="chapter" data-level="23.1" data-path="model-basics.html"><a href="model-basics.html#introduction-15"><i class="fa fa-check"></i><b>23.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="model-basics.html"><a href="model-basics.html#prerequisites-15"><i class="fa fa-check"></i><b>23.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="model-basics.html"><a href="model-basics.html#a-simple-model"><i class="fa fa-check"></i><b>23.2</b> A simple model</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="model-basics.html"><a href="model-basics.html#exercises-63"><i class="fa fa-check"></i><b>23.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="model-basics.html"><a href="model-basics.html#visualising-models"><i class="fa fa-check"></i><b>23.3</b> Visualising models</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="model-basics.html"><a href="model-basics.html#predictions"><i class="fa fa-check"></i><b>23.3.1</b> Predictions</a></li>
<li class="chapter" data-level="23.3.2" data-path="model-basics.html"><a href="model-basics.html#residuals"><i class="fa fa-check"></i><b>23.3.2</b> Residuals</a></li>
<li class="chapter" data-level="23.3.3" data-path="model-basics.html"><a href="model-basics.html#exercises-64"><i class="fa fa-check"></i><b>23.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="model-basics.html"><a href="model-basics.html#formulas-and-model-families"><i class="fa fa-check"></i><b>23.4</b> Formulas and model families</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="model-basics.html"><a href="model-basics.html#categorical-variables"><i class="fa fa-check"></i><b>23.4.1</b> Categorical variables</a></li>
<li class="chapter" data-level="23.4.2" data-path="model-basics.html"><a href="model-basics.html#interactions-continuous-and-categorical"><i class="fa fa-check"></i><b>23.4.2</b> Interactions (continuous and categorical)</a></li>
<li class="chapter" data-level="23.4.3" data-path="model-basics.html"><a href="model-basics.html#interactions-two-continuous"><i class="fa fa-check"></i><b>23.4.3</b> Interactions (two continuous)</a></li>
<li class="chapter" data-level="23.4.4" data-path="model-basics.html"><a href="model-basics.html#transformations"><i class="fa fa-check"></i><b>23.4.4</b> Transformations</a></li>
<li class="chapter" data-level="23.4.5" data-path="model-basics.html"><a href="model-basics.html#exercises-65"><i class="fa fa-check"></i><b>23.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="model-basics.html"><a href="model-basics.html#missing-values-5"><i class="fa fa-check"></i><b>23.5</b> Missing values</a></li>
<li class="chapter" data-level="23.6" data-path="model-basics.html"><a href="model-basics.html#other-model-families"><i class="fa fa-check"></i><b>23.6</b> Other model families</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>24</b> Model building</a>
<ul>
<li class="chapter" data-level="24.1" data-path="model-building.html"><a href="model-building.html#introduction-16"><i class="fa fa-check"></i><b>24.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="model-building.html"><a href="model-building.html#prerequisites-16"><i class="fa fa-check"></i><b>24.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="model-building.html"><a href="model-building.html#diamond-prices"><i class="fa fa-check"></i><b>24.2</b> Why are low quality diamonds more expensive?</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="model-building.html"><a href="model-building.html#price-and-carat"><i class="fa fa-check"></i><b>24.2.1</b> Price and carat</a></li>
<li class="chapter" data-level="24.2.2" data-path="model-building.html"><a href="model-building.html#a-more-complicated-model"><i class="fa fa-check"></i><b>24.2.2</b> A more complicated model</a></li>
<li class="chapter" data-level="24.2.3" data-path="model-building.html"><a href="model-building.html#exercises-66"><i class="fa fa-check"></i><b>24.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="model-building.html"><a href="model-building.html#what-affects-the-number-of-daily-flights"><i class="fa fa-check"></i><b>24.3</b> What affects the number of daily flights?</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="model-building.html"><a href="model-building.html#day-of-week"><i class="fa fa-check"></i><b>24.3.1</b> Day of week</a></li>
<li class="chapter" data-level="24.3.2" data-path="model-building.html"><a href="model-building.html#seasonal-saturday-effect"><i class="fa fa-check"></i><b>24.3.2</b> Seasonal Saturday effect</a></li>
<li class="chapter" data-level="24.3.3" data-path="model-building.html"><a href="model-building.html#computed-variables"><i class="fa fa-check"></i><b>24.3.3</b> Computed variables</a></li>
<li class="chapter" data-level="24.3.4" data-path="model-building.html"><a href="model-building.html#time-of-year-an-alternative-approach"><i class="fa fa-check"></i><b>24.3.4</b> Time of year: an alternative approach</a></li>
<li class="chapter" data-level="24.3.5" data-path="model-building.html"><a href="model-building.html#exercises-67"><i class="fa fa-check"></i><b>24.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-building.html"><a href="model-building.html#learning-more-about-models"><i class="fa fa-check"></i><b>24.4</b> Learning more about models</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="many-models.html"><a href="many-models.html"><i class="fa fa-check"></i><b>25</b> Many models</a>
<ul>
<li class="chapter" data-level="25.1" data-path="many-models.html"><a href="many-models.html#introduction-17"><i class="fa fa-check"></i><b>25.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="many-models.html"><a href="many-models.html#prerequisites-17"><i class="fa fa-check"></i><b>25.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="many-models.html"><a href="many-models.html#gapminder"><i class="fa fa-check"></i><b>25.2</b> gapminder</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="many-models.html"><a href="many-models.html#nested-data"><i class="fa fa-check"></i><b>25.2.1</b> Nested data</a></li>
<li class="chapter" data-level="25.2.2" data-path="many-models.html"><a href="many-models.html#list-columns"><i class="fa fa-check"></i><b>25.2.2</b> List-columns</a></li>
<li class="chapter" data-level="25.2.3" data-path="many-models.html"><a href="many-models.html#unnesting"><i class="fa fa-check"></i><b>25.2.3</b> Unnesting</a></li>
<li class="chapter" data-level="25.2.4" data-path="many-models.html"><a href="many-models.html#model-quality"><i class="fa fa-check"></i><b>25.2.4</b> Model quality</a></li>
<li class="chapter" data-level="25.2.5" data-path="many-models.html"><a href="many-models.html#exercises-68"><i class="fa fa-check"></i><b>25.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="many-models.html"><a href="many-models.html#list-columns-1"><i class="fa fa-check"></i><b>25.3</b> List-columns</a></li>
<li class="chapter" data-level="25.4" data-path="many-models.html"><a href="many-models.html#creating-list-columns"><i class="fa fa-check"></i><b>25.4</b> Creating list-columns</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="many-models.html"><a href="many-models.html#with-nesting"><i class="fa fa-check"></i><b>25.4.1</b> With nesting</a></li>
<li class="chapter" data-level="25.4.2" data-path="many-models.html"><a href="many-models.html#from-vectorised-functions"><i class="fa fa-check"></i><b>25.4.2</b> From vectorised functions</a></li>
<li class="chapter" data-level="25.4.3" data-path="many-models.html"><a href="many-models.html#from-multivalued-summaries"><i class="fa fa-check"></i><b>25.4.3</b> From multivalued summaries</a></li>
<li class="chapter" data-level="25.4.4" data-path="many-models.html"><a href="many-models.html#from-a-named-list"><i class="fa fa-check"></i><b>25.4.4</b> From a named list</a></li>
<li class="chapter" data-level="25.4.5" data-path="many-models.html"><a href="many-models.html#exercises-69"><i class="fa fa-check"></i><b>25.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="many-models.html"><a href="many-models.html#simplifying-list-columns"><i class="fa fa-check"></i><b>25.5</b> Simplifying list-columns</a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="many-models.html"><a href="many-models.html#list-to-vector"><i class="fa fa-check"></i><b>25.5.1</b> List to vector</a></li>
<li class="chapter" data-level="25.5.2" data-path="many-models.html"><a href="many-models.html#unnesting-1"><i class="fa fa-check"></i><b>25.5.2</b> Unnesting</a></li>
<li class="chapter" data-level="25.5.3" data-path="many-models.html"><a href="many-models.html#exercises-70"><i class="fa fa-check"></i><b>25.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="many-models.html"><a href="many-models.html#making-tidy-data-with-broom"><i class="fa fa-check"></i><b>25.6</b> Making tidy data with broom</a></li>
</ul></li>
<li class="part"><span><b>V Communicate</b></span></li>
<li class="chapter" data-level="26" data-path="communicate-intro.html"><a href="communicate-intro.html"><i class="fa fa-check"></i><b>26</b> Introduction</a></li>
<li class="chapter" data-level="27" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>27</b> R Markdown</a>
<ul>
<li class="chapter" data-level="27.1" data-path="r-markdown.html"><a href="r-markdown.html#introduction-18"><i class="fa fa-check"></i><b>27.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="r-markdown.html"><a href="r-markdown.html#prerequisites-18"><i class="fa fa-check"></i><b>27.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="r-markdown.html"><a href="r-markdown.html#r-markdown-basics"><i class="fa fa-check"></i><b>27.2</b> R Markdown basics</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="r-markdown.html"><a href="r-markdown.html#exercises-71"><i class="fa fa-check"></i><b>27.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="r-markdown.html"><a href="r-markdown.html#text-formatting-with-markdown"><i class="fa fa-check"></i><b>27.3</b> Text formatting with Markdown</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="r-markdown.html"><a href="r-markdown.html#exercises-72"><i class="fa fa-check"></i><b>27.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="r-markdown.html"><a href="r-markdown.html#code-chunks"><i class="fa fa-check"></i><b>27.4</b> Code chunks</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="r-markdown.html"><a href="r-markdown.html#chunk-name"><i class="fa fa-check"></i><b>27.4.1</b> Chunk name</a></li>
<li class="chapter" data-level="27.4.2" data-path="r-markdown.html"><a href="r-markdown.html#chunk-options"><i class="fa fa-check"></i><b>27.4.2</b> Chunk options</a></li>
<li class="chapter" data-level="27.4.3" data-path="r-markdown.html"><a href="r-markdown.html#table"><i class="fa fa-check"></i><b>27.4.3</b> Table</a></li>
<li class="chapter" data-level="27.4.4" data-path="r-markdown.html"><a href="r-markdown.html#caching"><i class="fa fa-check"></i><b>27.4.4</b> Caching</a></li>
<li class="chapter" data-level="27.4.5" data-path="r-markdown.html"><a href="r-markdown.html#global-options"><i class="fa fa-check"></i><b>27.4.5</b> Global options</a></li>
<li class="chapter" data-level="27.4.6" data-path="r-markdown.html"><a href="r-markdown.html#inline-code"><i class="fa fa-check"></i><b>27.4.6</b> Inline code</a></li>
<li class="chapter" data-level="27.4.7" data-path="r-markdown.html"><a href="r-markdown.html#exercises-73"><i class="fa fa-check"></i><b>27.4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="r-markdown.html"><a href="r-markdown.html#troubleshooting"><i class="fa fa-check"></i><b>27.5</b> Troubleshooting</a></li>
<li class="chapter" data-level="27.6" data-path="r-markdown.html"><a href="r-markdown.html#yaml-header"><i class="fa fa-check"></i><b>27.6</b> YAML header</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="r-markdown.html"><a href="r-markdown.html#parameters"><i class="fa fa-check"></i><b>27.6.1</b> Parameters</a></li>
<li class="chapter" data-level="27.6.2" data-path="r-markdown.html"><a href="r-markdown.html#bibliographies-and-citations"><i class="fa fa-check"></i><b>27.6.2</b> Bibliographies and Citations</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="r-markdown.html"><a href="r-markdown.html#learning-more-3"><i class="fa fa-check"></i><b>27.7</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html"><i class="fa fa-check"></i><b>28</b> Graphics for communication</a>
<ul>
<li class="chapter" data-level="28.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#introduction-19"><i class="fa fa-check"></i><b>28.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#prerequisites-19"><i class="fa fa-check"></i><b>28.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#label"><i class="fa fa-check"></i><b>28.2</b> Label</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#exercises-74"><i class="fa fa-check"></i><b>28.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#annotations"><i class="fa fa-check"></i><b>28.3</b> Annotations</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#exercises-75"><i class="fa fa-check"></i><b>28.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#scales"><i class="fa fa-check"></i><b>28.4</b> Scales</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#axis-ticks-and-legend-keys"><i class="fa fa-check"></i><b>28.4.1</b> Axis ticks and legend keys</a></li>
<li class="chapter" data-level="28.4.2" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#legend-layout"><i class="fa fa-check"></i><b>28.4.2</b> Legend layout</a></li>
<li class="chapter" data-level="28.4.3" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#replacing-a-scale"><i class="fa fa-check"></i><b>28.4.3</b> Replacing a scale</a></li>
<li class="chapter" data-level="28.4.4" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#exercises-76"><i class="fa fa-check"></i><b>28.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#zooming"><i class="fa fa-check"></i><b>28.5</b> Zooming</a></li>
<li class="chapter" data-level="28.6" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#themes"><i class="fa fa-check"></i><b>28.6</b> Themes</a></li>
<li class="chapter" data-level="28.7" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#saving-your-plots"><i class="fa fa-check"></i><b>28.7</b> Saving your plots</a>
<ul>
<li class="chapter" data-level="28.7.1" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#figure-sizing"><i class="fa fa-check"></i><b>28.7.1</b> Figure sizing</a></li>
<li class="chapter" data-level="28.7.2" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#other-important-options"><i class="fa fa-check"></i><b>28.7.2</b> Other important options</a></li>
</ul></li>
<li class="chapter" data-level="28.8" data-path="graphics-for-communication.html"><a href="graphics-for-communication.html#learning-more-4"><i class="fa fa-check"></i><b>28.8</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html"><i class="fa fa-check"></i><b>29</b> R Markdown formats</a>
<ul>
<li class="chapter" data-level="29.1" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#introduction-20"><i class="fa fa-check"></i><b>29.1</b> Introduction</a></li>
<li class="chapter" data-level="29.2" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#output-options"><i class="fa fa-check"></i><b>29.2</b> Output options</a></li>
<li class="chapter" data-level="29.3" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#documents"><i class="fa fa-check"></i><b>29.3</b> Documents</a></li>
<li class="chapter" data-level="29.4" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#notebooks"><i class="fa fa-check"></i><b>29.4</b> Notebooks</a></li>
<li class="chapter" data-level="29.5" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#presentations"><i class="fa fa-check"></i><b>29.5</b> Presentations</a></li>
<li class="chapter" data-level="29.6" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#dashboards"><i class="fa fa-check"></i><b>29.6</b> Dashboards</a></li>
<li class="chapter" data-level="29.7" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#interactivity"><i class="fa fa-check"></i><b>29.7</b> Interactivity</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#htmlwidgets"><i class="fa fa-check"></i><b>29.7.1</b> htmlwidgets</a></li>
<li class="chapter" data-level="29.7.2" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#shiny"><i class="fa fa-check"></i><b>29.7.2</b> Shiny</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#websites"><i class="fa fa-check"></i><b>29.8</b> Websites</a></li>
<li class="chapter" data-level="29.9" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#other-formats"><i class="fa fa-check"></i><b>29.9</b> Other formats</a></li>
<li class="chapter" data-level="29.10" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html#learning-more-5"><i class="fa fa-check"></i><b>29.10</b> Learning more</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="r-markdown-workflow.html"><a href="r-markdown-workflow.html"><i class="fa fa-check"></i><b>30</b> R Markdown workflow</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Science (2e)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relational-data" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Relational data</h1>
<div id="introduction-7" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Introduction</h2>
<p>It’s rare that a data analysis involves only a single table of data. Typically you have many tables of data, and you must combine them to answer the questions that you’re interested in. Collectively, multiple tables of data are called <strong>relational data</strong> because it is the relations, not just the individual datasets, that are important.</p>
<p>Relations are always defined between a pair of tables. All other relations are built up from this simple idea: the relations of three or more tables are always a property of the relations between each pair. Sometimes both elements of a pair can be the same table! This is needed if, for example, you have a table of people, and each person has a reference to their parents.</p>
<p>To work with relational data you need verbs that work with pairs of tables. There are three families of verbs designed to work with relational data:</p>
<ul>
<li><p><strong>Mutating joins</strong>, which add new variables to one data frame from matching
observations in another.</p></li>
<li><p><strong>Filtering joins</strong>, which filter observations from one data frame based on
whether or not they match an observation in the other table.</p></li>
<li><p><strong>Set operations</strong>, which treat observations as if they were set elements.</p></li>
</ul>
<p>The most common place to find relational data is in a <em>relational</em> database management system (or RDBMS), a term that encompasses almost all modern databases. If you’ve used a database before, you’ve almost certainly used SQL. If so, you should find the concepts in this chapter familiar, although their expression in dplyr is a little different. Generally, dplyr is a little easier to use than SQL because dplyr is specialised to do data analysis: it makes common data analysis operations easier, at the expense of making it more difficult to do other things that aren’t commonly needed for data analysis.</p>
<div id="prerequisites-7" class="section level3" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Prerequisites</h3>
<p>We will explore relational data from <code>nycflights13</code> using the two-table verbs from dplyr.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="relational-data.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb268-2"><a href="relational-data.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span></code></pre></div>
</div>
</div>
<div id="nycflights13-relational" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> nycflights13</h2>
<p>We will use the nycflights13 package to learn about relational data. nycflights13 contains five tibbles : <code>airlines</code>, <code>airports</code>, <code>weather</code> and <code>planes</code> which are all related to the <code>flights</code> table that you used in <a href="transform.html#transform">data transformation</a>:</p>
<ul>
<li><p><code>airlines</code> lets you look up the full carrier name from its abbreviated
code:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="relational-data.html#cb269-1" aria-hidden="true" tabindex="-1"></a>airlines</span>
<span id="cb269-2"><a href="relational-data.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 16 x 2</span></span>
<span id="cb269-3"><a href="relational-data.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   carrier name                    </span></span>
<span id="cb269-4"><a href="relational-data.html#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                   </span></span>
<span id="cb269-5"><a href="relational-data.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 9E      Endeavor Air Inc.       </span></span>
<span id="cb269-6"><a href="relational-data.html#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 AA      American Airlines Inc.  </span></span>
<span id="cb269-7"><a href="relational-data.html#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 AS      Alaska Airlines Inc.    </span></span>
<span id="cb269-8"><a href="relational-data.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 B6      JetBlue Airways         </span></span>
<span id="cb269-9"><a href="relational-data.html#cb269-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 DL      Delta Air Lines Inc.    </span></span>
<span id="cb269-10"><a href="relational-data.html#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 EV      ExpressJet Airlines Inc.</span></span>
<span id="cb269-11"><a href="relational-data.html#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 10 more rows</span></span></code></pre></div></li>
<li><p><code>airports</code> gives information about each airport, identified by the <code>faa</code>
airport code:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="relational-data.html#cb270-1" aria-hidden="true" tabindex="-1"></a>airports</span>
<span id="cb270-2"><a href="relational-data.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,458 x 8</span></span>
<span id="cb270-3"><a href="relational-data.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   faa   name                          lat   lon   alt    tz dst   tzone         </span></span>
<span id="cb270-4"><a href="relational-data.html#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;                       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;         </span></span>
<span id="cb270-5"><a href="relational-data.html#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 04G   Lansdowne Airport            41.1 -80.6  1044    -5 A     America/New_Y…</span></span>
<span id="cb270-6"><a href="relational-data.html#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 06A   Moton Field Municipal Airp…  32.5 -85.7   264    -6 A     America/Chica…</span></span>
<span id="cb270-7"><a href="relational-data.html#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 06C   Schaumburg Regional          42.0 -88.1   801    -6 A     America/Chica…</span></span>
<span id="cb270-8"><a href="relational-data.html#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 06N   Randall Airport              41.4 -74.4   523    -5 A     America/New_Y…</span></span>
<span id="cb270-9"><a href="relational-data.html#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 09J   Jekyll Island Airport        31.1 -81.4    11    -5 A     America/New_Y…</span></span>
<span id="cb270-10"><a href="relational-data.html#cb270-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0A9   Elizabethton Municipal Air…  36.4 -82.2  1593    -5 A     America/New_Y…</span></span>
<span id="cb270-11"><a href="relational-data.html#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1,452 more rows</span></span></code></pre></div></li>
<li><p><code>planes</code> gives information about each plane, identified by its <code>tailnum</code>:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="relational-data.html#cb271-1" aria-hidden="true" tabindex="-1"></a>planes</span>
<span id="cb271-2"><a href="relational-data.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3,322 x 9</span></span>
<span id="cb271-3"><a href="relational-data.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   tailnum  year type           manufacturer   model  engines seats speed engine </span></span>
<span id="cb271-4"><a href="relational-data.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  </span></span>
<span id="cb271-5"><a href="relational-data.html#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 N10156   2004 Fixed wing mu… EMBRAER        EMB-1…       2    55    NA Turbo-…</span></span>
<span id="cb271-6"><a href="relational-data.html#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 N102UW   1998 Fixed wing mu… AIRBUS INDUST… A320-…       2   182    NA Turbo-…</span></span>
<span id="cb271-7"><a href="relational-data.html#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 N103US   1999 Fixed wing mu… AIRBUS INDUST… A320-…       2   182    NA Turbo-…</span></span>
<span id="cb271-8"><a href="relational-data.html#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 N104UW   1999 Fixed wing mu… AIRBUS INDUST… A320-…       2   182    NA Turbo-…</span></span>
<span id="cb271-9"><a href="relational-data.html#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 N10575   2002 Fixed wing mu… EMBRAER        EMB-1…       2    55    NA Turbo-…</span></span>
<span id="cb271-10"><a href="relational-data.html#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 N105UW   1999 Fixed wing mu… AIRBUS INDUST… A320-…       2   182    NA Turbo-…</span></span>
<span id="cb271-11"><a href="relational-data.html#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 3,316 more rows</span></span></code></pre></div></li>
<li><p><code>weather</code> gives the weather at each NYC airport for each hour:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="relational-data.html#cb272-1" aria-hidden="true" tabindex="-1"></a>weather</span>
<span id="cb272-2"><a href="relational-data.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 26,115 x 15</span></span>
<span id="cb272-3"><a href="relational-data.html#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed wind_gust</span></span>
<span id="cb272-4"><a href="relational-data.html#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb272-5"><a href="relational-data.html#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4         NA</span></span>
<span id="cb272-6"><a href="relational-data.html#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06        NA</span></span>
<span id="cb272-7"><a href="relational-data.html#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5         NA</span></span>
<span id="cb272-8"><a href="relational-data.html#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7         NA</span></span>
<span id="cb272-9"><a href="relational-data.html#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7         NA</span></span>
<span id="cb272-10"><a href="relational-data.html#cb272-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5         NA</span></span>
<span id="cb272-11"><a href="relational-data.html#cb272-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 26,109 more rows, and 4 more variables: precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span></span>
<span id="cb272-12"><a href="relational-data.html#cb272-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div></li>
</ul>
<p>One way to show the relationships between the different tables is with a drawing:</p>
<p><img src="diagrams/relational-nycflights.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This diagram is a little overwhelming, but it’s simple compared to some you’ll see in the wild! The key to understanding diagrams like this is to remember each relation always concerns a pair of tables. You don’t need to understand the whole thing; you just need to understand the chain of relations between the tables that you are interested in.</p>
<p>For nycflights13:</p>
<ul>
<li><p><code>flights</code> connects to <code>planes</code> via a single variable, <code>tailnum</code>.</p></li>
<li><p><code>flights</code> connects to <code>airlines</code> through the <code>carrier</code> variable.</p></li>
<li><p><code>flights</code> connects to <code>airports</code> in two ways: via the <code>origin</code> and
<code>dest</code> variables.</p></li>
<li><p><code>flights</code> connects to <code>weather</code> via <code>origin</code> (the location), and
<code>year</code>, <code>month</code>, <code>day</code> and <code>hour</code> (the time).</p></li>
</ul>
<div id="exercises-28" class="section level3" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Imagine you wanted to draw (approximately) the route each plane flies from
its origin to its destination. What variables would you need? What tables
would you need to combine?</p></li>
<li><p>I forgot to draw the relationship between <code>weather</code> and <code>airports</code>.
What is the relationship and how should it appear in the diagram?</p></li>
<li><p><code>weather</code> only contains information for the origin (NYC) airports. If
it contained weather records for all airports in the USA, what additional
relation would it define with <code>flights</code>?</p></li>
<li><p>We know that some days of the year are “special”, and fewer people than
usual fly on them. How might you represent that data as a data frame?
What would be the primary keys of that table? How would it connect to the
existing tables?</p></li>
</ol>
</div>
</div>
<div id="keys" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Keys</h2>
<p>The variables used to connect each pair of tables are called <strong>keys</strong>. A key is a variable (or set of variables) that uniquely identifies an observation. In simple cases, a single variable is sufficient to identify an observation. For example, each plane is uniquely identified by its <code>tailnum</code>. In other cases, multiple variables may be needed. For example, to identify an observation in <code>weather</code> you need five variables: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, and <code>origin</code>.</p>
<p>There are two types of keys:</p>
<ul>
<li><p>A <strong>primary key</strong> uniquely identifies an observation in its own table.
For example, <code>planes$tailnum</code> is a primary key because it uniquely identifies
each plane in the <code>planes</code> table.</p></li>
<li><p>A <strong>foreign key</strong> uniquely identifies an observation in another table.
For example, <code>flights$tailnum</code> is a foreign key because it appears in the
<code>flights</code> table where it matches each flight to a unique plane.</p></li>
</ul>
<p>A variable can be both a primary key <em>and</em> a foreign key. For example, <code>origin</code> is part of the <code>weather</code> primary key, and is also a foreign key for the <code>airports</code> table.</p>
<p>Once you’ve identified the primary keys in your tables, it’s good practice to verify that they do indeed uniquely identify each observation. One way to do that is to <code>count()</code> the primary keys and look for entries where <code>n</code> is greater than one:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="relational-data.html#cb273-1" aria-hidden="true" tabindex="-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb273-2"><a href="relational-data.html#cb273-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum) <span class="sc">%&gt;%</span> </span>
<span id="cb273-3"><a href="relational-data.html#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb273-4"><a href="relational-data.html#cb273-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 0 x 2</span></span>
<span id="cb273-5"><a href="relational-data.html#cb273-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</span></span>
<span id="cb273-6"><a href="relational-data.html#cb273-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-7"><a href="relational-data.html#cb273-7" aria-hidden="true" tabindex="-1"></a>weather <span class="sc">%&gt;%</span> </span>
<span id="cb273-8"><a href="relational-data.html#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year, month, day, hour, origin) <span class="sc">%&gt;%</span> </span>
<span id="cb273-9"><a href="relational-data.html#cb273-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb273-10"><a href="relational-data.html#cb273-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 x 6</span></span>
<span id="cb273-11"><a href="relational-data.html#cb273-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour origin     n</span></span>
<span id="cb273-12"><a href="relational-data.html#cb273-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;</span></span>
<span id="cb273-13"><a href="relational-data.html#cb273-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013    11     3     1 EWR        2</span></span>
<span id="cb273-14"><a href="relational-data.html#cb273-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013    11     3     1 JFK        2</span></span>
<span id="cb273-15"><a href="relational-data.html#cb273-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013    11     3     1 LGA        2</span></span></code></pre></div>
<p>Sometimes a table doesn’t have an explicit primary key: each row is an observation, but no combination of variables reliably identifies it. For example, what’s the primary key in the <code>flights</code> table? You might think it would be the date plus the flight or tail number, but neither of those are unique:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="relational-data.html#cb274-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb274-2"><a href="relational-data.html#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year, month, day, flight) <span class="sc">%&gt;%</span> </span>
<span id="cb274-3"><a href="relational-data.html#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb274-4"><a href="relational-data.html#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 29,768 x 5</span></span>
<span id="cb274-5"><a href="relational-data.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day flight     n</span></span>
<span id="cb274-6"><a href="relational-data.html#cb274-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb274-7"><a href="relational-data.html#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1      1     2</span></span>
<span id="cb274-8"><a href="relational-data.html#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1      3     2</span></span>
<span id="cb274-9"><a href="relational-data.html#cb274-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1      4     2</span></span>
<span id="cb274-10"><a href="relational-data.html#cb274-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     11     3</span></span>
<span id="cb274-11"><a href="relational-data.html#cb274-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     15     2</span></span>
<span id="cb274-12"><a href="relational-data.html#cb274-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     21     2</span></span>
<span id="cb274-13"><a href="relational-data.html#cb274-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 29,762 more rows</span></span>
<span id="cb274-14"><a href="relational-data.html#cb274-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-15"><a href="relational-data.html#cb274-15" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb274-16"><a href="relational-data.html#cb274-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year, month, day, tailnum) <span class="sc">%&gt;%</span> </span>
<span id="cb274-17"><a href="relational-data.html#cb274-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb274-18"><a href="relational-data.html#cb274-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 64,928 x 5</span></span>
<span id="cb274-19"><a href="relational-data.html#cb274-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day tailnum     n</span></span>
<span id="cb274-20"><a href="relational-data.html#cb274-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;int&gt;</span></span>
<span id="cb274-21"><a href="relational-data.html#cb274-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1 N0EGMQ      2</span></span>
<span id="cb274-22"><a href="relational-data.html#cb274-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1 N11189      2</span></span>
<span id="cb274-23"><a href="relational-data.html#cb274-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1 N11536      2</span></span>
<span id="cb274-24"><a href="relational-data.html#cb274-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1 N11544      3</span></span>
<span id="cb274-25"><a href="relational-data.html#cb274-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1 N11551      2</span></span>
<span id="cb274-26"><a href="relational-data.html#cb274-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1 N12540      2</span></span>
<span id="cb274-27"><a href="relational-data.html#cb274-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 64,922 more rows</span></span></code></pre></div>
<p>When starting to work with this data, I had naively assumed that each flight number would be only used once per day: that would make it much easier to communicate problems with a specific flight. Unfortunately that is not the case! If a table lacks a primary key, it’s sometimes useful to add one with <code>mutate()</code> and <code>row_number()</code>. That makes it easier to match observations if you’ve done some filtering and want to check back in with the original data. This is called a <strong>surrogate key</strong>.</p>
<p>A primary key and the corresponding foreign key in another table form a <strong>relation</strong>. Relations are typically one-to-many. For example, each flight has one plane, but each plane has many flights. In other data, you’ll occasionally see a 1-to-1 relationship. You can think of this as a special case of 1-to-many. You can model many-to-many relations with a many-to-1 relation plus a 1-to-many relation. For example, in this data there’s a many-to-many relationship between airlines and airports: each airline flies to many airports; each airport hosts many airlines.</p>
<div id="exercises-29" class="section level3" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Add a surrogate key to <code>flights</code>.</p></li>
<li><p>Identify the keys in the following datasets</p>
<ol style="list-style-type: decimal">
<li><code>Lahman::Batting</code>,</li>
<li><code>babynames::babynames</code></li>
<li><code>nasaweather::atmos</code></li>
<li><code>fueleconomy::vehicles</code></li>
<li><code>ggplot2::diamonds</code></li>
</ol>
<p>(You might need to install some packages and read some documentation.)</p></li>
<li><p>Draw a diagram illustrating the connections between the <code>Batting</code>,
<code>People</code>, and <code>Salaries</code> tables in the Lahman package. Draw another diagram
that shows the relationship between <code>People</code>, <code>Managers</code>, <code>AwardsManagers</code>.</p>
<p>How would you characterise the relationship between the <code>Batting</code>,
<code>Pitching</code>, and <code>Fielding</code> tables?</p></li>
</ol>
</div>
</div>
<div id="mutating-joins" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Mutating joins</h2>
<p>The first tool we’ll look at for combining a pair of tables is the <strong>mutating join</strong>. A mutating join allows you to combine variables from two tables. It first matches observations by their keys, then copies across variables from one table to the other.</p>
<p>Like <code>mutate()</code>, the join functions add variables to the right, so if you have a lot of variables already, the new variables won’t get printed out. For these examples, we’ll make it easier to see what’s going on in the examples by creating a narrower dataset:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="relational-data.html#cb275-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> </span>
<span id="cb275-2"><a href="relational-data.html#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day, hour, origin, dest, tailnum, carrier)</span>
<span id="cb275-3"><a href="relational-data.html#cb275-3" aria-hidden="true" tabindex="-1"></a>flights2</span>
<span id="cb275-4"><a href="relational-data.html#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 8</span></span>
<span id="cb275-5"><a href="relational-data.html#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour origin dest  tailnum carrier</span></span>
<span id="cb275-6"><a href="relational-data.html#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  </span></span>
<span id="cb275-7"><a href="relational-data.html#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 EWR    IAH   N14228  UA     </span></span>
<span id="cb275-8"><a href="relational-data.html#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 LGA    IAH   N24211  UA     </span></span>
<span id="cb275-9"><a href="relational-data.html#cb275-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 JFK    MIA   N619AA  AA     </span></span>
<span id="cb275-10"><a href="relational-data.html#cb275-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 JFK    BQN   N804JB  B6     </span></span>
<span id="cb275-11"><a href="relational-data.html#cb275-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 LGA    ATL   N668DN  DL     </span></span>
<span id="cb275-12"><a href="relational-data.html#cb275-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 EWR    ORD   N39463  UA     </span></span>
<span id="cb275-13"><a href="relational-data.html#cb275-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows</span></span></code></pre></div>
<p>(Remember, when you’re in RStudio, you can also use <code>View()</code> to avoid this problem.)</p>
<p>Imagine you want to add the full airline name to the <code>flights2</code> data. You can combine the <code>airlines</code> and <code>flights2</code> data frames with <code>left_join()</code>:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="relational-data.html#cb276-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span></span>
<span id="cb276-2"><a href="relational-data.html#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>origin, <span class="sc">-</span>dest) <span class="sc">%&gt;%</span> </span>
<span id="cb276-3"><a href="relational-data.html#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airlines, <span class="at">by =</span> <span class="st">&quot;carrier&quot;</span>)</span>
<span id="cb276-4"><a href="relational-data.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 7</span></span>
<span id="cb276-5"><a href="relational-data.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour tailnum carrier name                  </span></span>
<span id="cb276-6"><a href="relational-data.html#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                 </span></span>
<span id="cb276-7"><a href="relational-data.html#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 N14228  UA      United Air Lines Inc. </span></span>
<span id="cb276-8"><a href="relational-data.html#cb276-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 N24211  UA      United Air Lines Inc. </span></span>
<span id="cb276-9"><a href="relational-data.html#cb276-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 N619AA  AA      American Airlines Inc.</span></span>
<span id="cb276-10"><a href="relational-data.html#cb276-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 N804JB  B6      JetBlue Airways       </span></span>
<span id="cb276-11"><a href="relational-data.html#cb276-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 N668DN  DL      Delta Air Lines Inc.  </span></span>
<span id="cb276-12"><a href="relational-data.html#cb276-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 N39463  UA      United Air Lines Inc. </span></span>
<span id="cb276-13"><a href="relational-data.html#cb276-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows</span></span></code></pre></div>
<p>The result of joining airlines to flights2 is an additional variable: <code>name</code>. This is why I call this type of join a mutating join. In this case, you could have got to the same place using <code>mutate()</code> and R’s base subsetting:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="relational-data.html#cb277-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span></span>
<span id="cb277-2"><a href="relational-data.html#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>origin, <span class="sc">-</span>dest) <span class="sc">%&gt;%</span> </span>
<span id="cb277-3"><a href="relational-data.html#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> airlines<span class="sc">$</span>name[<span class="fu">match</span>(carrier, airlines<span class="sc">$</span>carrier)])</span>
<span id="cb277-4"><a href="relational-data.html#cb277-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 7</span></span>
<span id="cb277-5"><a href="relational-data.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour tailnum carrier name                  </span></span>
<span id="cb277-6"><a href="relational-data.html#cb277-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                 </span></span>
<span id="cb277-7"><a href="relational-data.html#cb277-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 N14228  UA      United Air Lines Inc. </span></span>
<span id="cb277-8"><a href="relational-data.html#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 N24211  UA      United Air Lines Inc. </span></span>
<span id="cb277-9"><a href="relational-data.html#cb277-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 N619AA  AA      American Airlines Inc.</span></span>
<span id="cb277-10"><a href="relational-data.html#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 N804JB  B6      JetBlue Airways       </span></span>
<span id="cb277-11"><a href="relational-data.html#cb277-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 N668DN  DL      Delta Air Lines Inc.  </span></span>
<span id="cb277-12"><a href="relational-data.html#cb277-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 N39463  UA      United Air Lines Inc. </span></span>
<span id="cb277-13"><a href="relational-data.html#cb277-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows</span></span></code></pre></div>
<p>But this is hard to generalise when you need to match multiple variables, and takes close reading to figure out the overall intent.</p>
<p>The following sections explain, in detail, how mutating joins work. You’ll start by learning a useful visual representation of joins. We’ll then use that to explain the four mutating join functions: the inner join, and the three outer joins. When working with real data, keys don’t always uniquely identify observations, so next we’ll talk about what happens when there isn’t a unique match. Finally, you’ll learn how to tell dplyr which variables are the keys for a given join.</p>
<div id="understanding-joins" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Understanding joins</h3>
<p>To help you learn how joins work, I’m going to use a visual representation:</p>
<p><img src="diagrams/join-setup.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="relational-data.html#cb278-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb278-2"><a href="relational-data.html#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb278-3"><a href="relational-data.html#cb278-3" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb278-4"><a href="relational-data.html#cb278-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</span>
<span id="cb278-5"><a href="relational-data.html#cb278-5" aria-hidden="true" tabindex="-1"></a>     <span class="dv">3</span>, <span class="st">&quot;x3&quot;</span></span>
<span id="cb278-6"><a href="relational-data.html#cb278-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb278-7"><a href="relational-data.html#cb278-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb278-8"><a href="relational-data.html#cb278-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb278-9"><a href="relational-data.html#cb278-9" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</span>
<span id="cb278-10"><a href="relational-data.html#cb278-10" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span>,</span>
<span id="cb278-11"><a href="relational-data.html#cb278-11" aria-hidden="true" tabindex="-1"></a>     <span class="dv">4</span>, <span class="st">&quot;y3&quot;</span></span>
<span id="cb278-12"><a href="relational-data.html#cb278-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The coloured column represents the “key” variable: these are used to match the rows between the tables. The grey column represents the “value” column that is carried along for the ride. In these examples I’ll show a single key variable, but the idea generalises in a straightforward way to multiple keys and multiple values.</p>
<p>A join is a way of connecting each row in <code>x</code> to zero, one, or more rows in <code>y</code>. The following diagram shows each potential match as an intersection of a pair of lines.</p>
<p><img src="diagrams/join-setup2.png" style="display: block; margin: auto;" /></p>
<p>(If you look closely, you might notice that we’ve switched the order of the key and value columns in <code>x</code>. This is to emphasise that joins match based on the key; the value is just carried along for the ride.)</p>
<p>In an actual join, matches will be indicated with dots. The number of dots = the number of matches = the number of rows in the output.</p>
<p><img src="diagrams/join-inner.png" style="display: block; margin: auto;" /></p>
</div>
<div id="inner-join" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Inner join</h3>
<p>The simplest type of join is the <strong>inner join</strong>. An inner join matches pairs of observations whenever their keys are equal:</p>
<p><img src="diagrams/join-inner.png" style="display: block; margin: auto;" /></p>
<p>(To be precise, this is an inner <strong>equijoin</strong> because the keys are matched using the equality operator. Since most joins are equijoins we usually drop that specification.)</p>
<p>The output of an inner join is a new data frame that contains the key, the x values, and the y values. We use <code>by</code> to tell dplyr which variable is the key:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="relational-data.html#cb279-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> </span>
<span id="cb279-2"><a href="relational-data.html#cb279-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(y, <span class="at">by =</span> <span class="st">&quot;key&quot;</span>)</span>
<span id="cb279-3"><a href="relational-data.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 x 3</span></span>
<span id="cb279-4"><a href="relational-data.html#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     key val_x val_y</span></span>
<span id="cb279-5"><a href="relational-data.html#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb279-6"><a href="relational-data.html#cb279-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 x1    y1   </span></span>
<span id="cb279-7"><a href="relational-data.html#cb279-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2 x2    y2</span></span></code></pre></div>
<p>The most important property of an inner join is that unmatched rows are not included in the result. This means that generally inner joins are usually not appropriate for use in analysis because it’s too easy to lose observations.</p>
</div>
<div id="outer-join" class="section level3" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> Outer joins</h3>
<p>An inner join keeps observations that appear in both tables. An <strong>outer join</strong> keeps observations that appear in at least one of the tables. There are three types of outer joins:</p>
<ul>
<li>A <strong>left join</strong> keeps all observations in <code>x</code>.</li>
<li>A <strong>right join</strong> keeps all observations in <code>y</code>.</li>
<li>A <strong>full join</strong> keeps all observations in <code>x</code> and <code>y</code>.</li>
</ul>
<p>These joins work by adding an additional “virtual” observation to each table. This observation has a key that always matches (if no other key matches), and a value filled with <code>NA</code>.</p>
<p>Graphically, that looks like:</p>
<p><img src="diagrams/join-outer.png" style="display: block; margin: auto;" /></p>
<p>The most commonly used join is the left join: you use this whenever you look up additional data from another table, because it preserves the original observations even when there isn’t a match. The left join should be your default join: use it unless you have a strong reason to prefer one of the others.</p>
<p>Another way to depict the different types of joins is with a Venn diagram:</p>
<p><img src="diagrams/join-venn.png" style="display: block; margin: auto;" /></p>
<p>However, this is not a great representation. It might jog your memory about which join preserves the observations in which table, but it suffers from a major limitation: a Venn diagram can’t show what happens when keys don’t uniquely identify an observation.</p>
</div>
<div id="join-matches" class="section level3" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Duplicate keys</h3>
<p>So far all the diagrams have assumed that the keys are unique. But that’s not always the case. This section explains what happens when the keys are not unique. There are two possibilities:</p>
<ol style="list-style-type: decimal">
<li><p>One table has duplicate keys. This is useful when you want to
add in additional information as there is typically a one-to-many
relationship.</p>
<p><img src="diagrams/join-one-to-many.png" style="display: block; margin: auto;" /></p>
<p>Note that I’ve put the key column in a slightly different position
in the output. This reflects that the key is a primary key in <code>y</code>
and a foreign key in <code>x</code>.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="relational-data.html#cb280-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb280-2"><a href="relational-data.html#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb280-3"><a href="relational-data.html#cb280-3" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb280-4"><a href="relational-data.html#cb280-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</span>
<span id="cb280-5"><a href="relational-data.html#cb280-5" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;x3&quot;</span>,</span>
<span id="cb280-6"><a href="relational-data.html#cb280-6" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;x4&quot;</span></span>
<span id="cb280-7"><a href="relational-data.html#cb280-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-8"><a href="relational-data.html#cb280-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb280-9"><a href="relational-data.html#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb280-10"><a href="relational-data.html#cb280-10" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</span>
<span id="cb280-11"><a href="relational-data.html#cb280-11" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span></span>
<span id="cb280-12"><a href="relational-data.html#cb280-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-13"><a href="relational-data.html#cb280-13" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y, <span class="at">by =</span> <span class="st">&quot;key&quot;</span>)</span>
<span id="cb280-14"><a href="relational-data.html#cb280-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 x 3</span></span>
<span id="cb280-15"><a href="relational-data.html#cb280-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     key val_x val_y</span></span>
<span id="cb280-16"><a href="relational-data.html#cb280-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb280-17"><a href="relational-data.html#cb280-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 x1    y1   </span></span>
<span id="cb280-18"><a href="relational-data.html#cb280-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2 x2    y2   </span></span>
<span id="cb280-19"><a href="relational-data.html#cb280-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     2 x3    y2   </span></span>
<span id="cb280-20"><a href="relational-data.html#cb280-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     1 x4    y1</span></span></code></pre></div></li>
<li><p>Both tables have duplicate keys. This is usually an error because in
neither table do the keys uniquely identify an observation. When you join
duplicated keys, you get all possible combinations, the Cartesian product:</p>
<p><img src="diagrams/join-many-to-many.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="relational-data.html#cb281-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb281-2"><a href="relational-data.html#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_x,</span>
<span id="cb281-3"><a href="relational-data.html#cb281-3" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb281-4"><a href="relational-data.html#cb281-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;x2&quot;</span>,</span>
<span id="cb281-5"><a href="relational-data.html#cb281-5" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;x3&quot;</span>,</span>
<span id="cb281-6"><a href="relational-data.html#cb281-6" aria-hidden="true" tabindex="-1"></a>     <span class="dv">3</span>, <span class="st">&quot;x4&quot;</span></span>
<span id="cb281-7"><a href="relational-data.html#cb281-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-8"><a href="relational-data.html#cb281-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb281-9"><a href="relational-data.html#cb281-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>key, <span class="sc">~</span>val_y,</span>
<span id="cb281-10"><a href="relational-data.html#cb281-10" aria-hidden="true" tabindex="-1"></a>     <span class="dv">1</span>, <span class="st">&quot;y1&quot;</span>,</span>
<span id="cb281-11"><a href="relational-data.html#cb281-11" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;y2&quot;</span>,</span>
<span id="cb281-12"><a href="relational-data.html#cb281-12" aria-hidden="true" tabindex="-1"></a>     <span class="dv">2</span>, <span class="st">&quot;y3&quot;</span>,</span>
<span id="cb281-13"><a href="relational-data.html#cb281-13" aria-hidden="true" tabindex="-1"></a>     <span class="dv">3</span>, <span class="st">&quot;y4&quot;</span></span>
<span id="cb281-14"><a href="relational-data.html#cb281-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-15"><a href="relational-data.html#cb281-15" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(x, y, <span class="at">by =</span> <span class="st">&quot;key&quot;</span>)</span>
<span id="cb281-16"><a href="relational-data.html#cb281-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 x 3</span></span>
<span id="cb281-17"><a href="relational-data.html#cb281-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     key val_x val_y</span></span>
<span id="cb281-18"><a href="relational-data.html#cb281-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb281-19"><a href="relational-data.html#cb281-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1 x1    y1   </span></span>
<span id="cb281-20"><a href="relational-data.html#cb281-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2 x2    y2   </span></span>
<span id="cb281-21"><a href="relational-data.html#cb281-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     2 x2    y3   </span></span>
<span id="cb281-22"><a href="relational-data.html#cb281-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     2 x3    y2   </span></span>
<span id="cb281-23"><a href="relational-data.html#cb281-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     2 x3    y3   </span></span>
<span id="cb281-24"><a href="relational-data.html#cb281-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     3 x4    y4</span></span></code></pre></div></li>
</ol>
</div>
<div id="join-by" class="section level3" number="13.4.5">
<h3><span class="header-section-number">13.4.5</span> Defining the key columns</h3>
<p>So far, the pairs of tables have always been joined by a single variable, and that variable has the same name in both tables. That constraint was encoded by <code>by = "key"</code>. You can use other values for <code>by</code> to connect the tables in other ways:</p>
<ul>
<li><p>The default, <code>by = NULL</code>, uses all variables that appear in both tables,
the so called <strong>natural</strong> join. For example, the flights and weather tables
match on their common variables: <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code> and
<code>origin</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="relational-data.html#cb282-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="relational-data.html#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(weather)</span>
<span id="cb282-3"><a href="relational-data.html#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Joining, by = c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;hour&quot;, &quot;origin&quot;)</span></span>
<span id="cb282-4"><a href="relational-data.html#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 18</span></span>
<span id="cb282-5"><a href="relational-data.html#cb282-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour origin dest  tailnum carrier  temp  dewp humid</span></span>
<span id="cb282-6"><a href="relational-data.html#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb282-7"><a href="relational-data.html#cb282-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 EWR    IAH   N14228  UA       39.0  28.0  64.4</span></span>
<span id="cb282-8"><a href="relational-data.html#cb282-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 LGA    IAH   N24211  UA       39.9  25.0  54.8</span></span>
<span id="cb282-9"><a href="relational-data.html#cb282-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 JFK    MIA   N619AA  AA       39.0  27.0  61.6</span></span>
<span id="cb282-10"><a href="relational-data.html#cb282-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 JFK    BQN   N804JB  B6       39.0  27.0  61.6</span></span>
<span id="cb282-11"><a href="relational-data.html#cb282-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 LGA    ATL   N668DN  DL       39.9  25.0  54.8</span></span>
<span id="cb282-12"><a href="relational-data.html#cb282-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 EWR    ORD   N39463  UA       39.0  28.0  64.4</span></span>
<span id="cb282-13"><a href="relational-data.html#cb282-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows, and 7 more variables: wind_dir &lt;dbl&gt;,</span></span>
<span id="cb282-14"><a href="relational-data.html#cb282-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   wind_speed &lt;dbl&gt;, wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,</span></span>
<span id="cb282-15"><a href="relational-data.html#cb282-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div></li>
<li><p>A character vector, <code>by = "x"</code>. This is like a natural join, but uses only
some of the common variables. For example, <code>flights</code> and <code>planes</code> have
<code>year</code> variables, but they mean different things so we only want to join by
<code>tailnum</code>.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="relational-data.html#cb283-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb283-2"><a href="relational-data.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>)</span>
<span id="cb283-3"><a href="relational-data.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 16</span></span>
<span id="cb283-4"><a href="relational-data.html#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   year.x month   day  hour origin dest  tailnum carrier year.y type </span></span>
<span id="cb283-5"><a href="relational-data.html#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;</span></span>
<span id="cb283-6"><a href="relational-data.html#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   2013     1     1     5 EWR    IAH   N14228  UA        1999 Fixe…</span></span>
<span id="cb283-7"><a href="relational-data.html#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   2013     1     1     5 LGA    IAH   N24211  UA        1998 Fixe…</span></span>
<span id="cb283-8"><a href="relational-data.html#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   2013     1     1     5 JFK    MIA   N619AA  AA        1990 Fixe…</span></span>
<span id="cb283-9"><a href="relational-data.html#cb283-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   2013     1     1     5 JFK    BQN   N804JB  B6        2012 Fixe…</span></span>
<span id="cb283-10"><a href="relational-data.html#cb283-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   2013     1     1     6 LGA    ATL   N668DN  DL        1991 Fixe…</span></span>
<span id="cb283-11"><a href="relational-data.html#cb283-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   2013     1     1     5 EWR    ORD   N39463  UA        2012 Fixe…</span></span>
<span id="cb283-12"><a href="relational-data.html#cb283-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows, and 6 more variables: manufacturer &lt;chr&gt;,</span></span>
<span id="cb283-13"><a href="relational-data.html#cb283-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</span></span></code></pre></div>
<p>Note that the <code>year</code> variables (which appear in both input data frames,
but are not constrained to be equal) are disambiguated in the output with
a suffix.</p></li>
<li><p>A named character vector: <code>by = c("a" = "b")</code>. This will
match variable <code>a</code> in table <code>x</code> to variable <code>b</code> in table <code>y</code>. The
variables from <code>x</code> will be used in the output.</p>
<p>For example, if we want to draw a map we need to combine the flights data
with the airports data which contains the location (<code>lat</code> and <code>lon</code>) of
each airport. Each flight has an origin and destination <code>airport</code>, so we
need to specify which one we want to join to:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="relational-data.html#cb284-1" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb284-2"><a href="relational-data.html#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airports, <span class="fu">c</span>(<span class="st">&quot;dest&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>))</span>
<span id="cb284-3"><a href="relational-data.html#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 15</span></span>
<span id="cb284-4"><a href="relational-data.html#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour origin dest  tailnum carrier name    lat   lon   alt</span></span>
<span id="cb284-5"><a href="relational-data.html#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb284-6"><a href="relational-data.html#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 EWR    IAH   N14228  UA      Geor…  30.0 -95.3    97</span></span>
<span id="cb284-7"><a href="relational-data.html#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 LGA    IAH   N24211  UA      Geor…  30.0 -95.3    97</span></span>
<span id="cb284-8"><a href="relational-data.html#cb284-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 JFK    MIA   N619AA  AA      Miam…  25.8 -80.3     8</span></span>
<span id="cb284-9"><a href="relational-data.html#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 JFK    BQN   N804JB  B6      &lt;NA&gt;   NA    NA      NA</span></span>
<span id="cb284-10"><a href="relational-data.html#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 LGA    ATL   N668DN  DL      Hart…  33.6 -84.4  1026</span></span>
<span id="cb284-11"><a href="relational-data.html#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 EWR    ORD   N39463  UA      Chic…  42.0 -87.9   668</span></span>
<span id="cb284-12"><a href="relational-data.html#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows, and 3 more variables: tz &lt;dbl&gt;, dst &lt;chr&gt;,</span></span>
<span id="cb284-13"><a href="relational-data.html#cb284-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   tzone &lt;chr&gt;</span></span>
<span id="cb284-14"><a href="relational-data.html#cb284-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-15"><a href="relational-data.html#cb284-15" aria-hidden="true" tabindex="-1"></a>flights2 <span class="sc">%&gt;%</span> </span>
<span id="cb284-16"><a href="relational-data.html#cb284-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(airports, <span class="fu">c</span>(<span class="st">&quot;origin&quot;</span> <span class="ot">=</span> <span class="st">&quot;faa&quot;</span>))</span>
<span id="cb284-17"><a href="relational-data.html#cb284-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 336,776 x 15</span></span>
<span id="cb284-18"><a href="relational-data.html#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day  hour origin dest  tailnum carrier name    lat   lon   alt</span></span>
<span id="cb284-19"><a href="relational-data.html#cb284-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb284-20"><a href="relational-data.html#cb284-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1     5 EWR    IAH   N14228  UA      Newa…  40.7 -74.2    18</span></span>
<span id="cb284-21"><a href="relational-data.html#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1     5 LGA    IAH   N24211  UA      La G…  40.8 -73.9    22</span></span>
<span id="cb284-22"><a href="relational-data.html#cb284-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1     5 JFK    MIA   N619AA  AA      John…  40.6 -73.8    13</span></span>
<span id="cb284-23"><a href="relational-data.html#cb284-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1     5 JFK    BQN   N804JB  B6      John…  40.6 -73.8    13</span></span>
<span id="cb284-24"><a href="relational-data.html#cb284-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1     6 LGA    ATL   N668DN  DL      La G…  40.8 -73.9    22</span></span>
<span id="cb284-25"><a href="relational-data.html#cb284-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1     5 EWR    ORD   N39463  UA      Newa…  40.7 -74.2    18</span></span>
<span id="cb284-26"><a href="relational-data.html#cb284-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 336,770 more rows, and 3 more variables: tz &lt;dbl&gt;, dst &lt;chr&gt;,</span></span>
<span id="cb284-27"><a href="relational-data.html#cb284-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   tzone &lt;chr&gt;</span></span></code></pre></div></li>
</ul>
</div>
<div id="exercises-30" class="section level3" number="13.4.6">
<h3><span class="header-section-number">13.4.6</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Compute the average delay by destination, then join on the <code>airports</code>
data frame so you can show the spatial distribution of delays. Here’s an
easy way to draw a map of the United States:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="relational-data.html#cb285-1" aria-hidden="true" tabindex="-1"></a>airports <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="relational-data.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(flights, <span class="fu">c</span>(<span class="st">&quot;faa&quot;</span> <span class="ot">=</span> <span class="st">&quot;dest&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb285-3"><a href="relational-data.html#cb285-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(lon, lat)) <span class="sc">+</span></span>
<span id="cb285-4"><a href="relational-data.html#cb285-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">borders</span>(<span class="st">&quot;state&quot;</span>) <span class="sc">+</span></span>
<span id="cb285-5"><a href="relational-data.html#cb285-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb285-6"><a href="relational-data.html#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_quickmap</span>()</span></code></pre></div>
<p>(Don’t worry if you don’t understand what <code>semi_join()</code> does — you’ll
learn about it next.)</p>
<p>You might want to use the <code>size</code> or <code>colour</code> of the points to display
the average delay for each airport.</p></li>
<li><p>Add the location of the origin <em>and</em> destination (i.e. the <code>lat</code> and <code>lon</code>)
to <code>flights</code>.</p></li>
<li><p>Is there a relationship between the age of a plane and its delays?</p></li>
<li><p>What weather conditions make it more likely to see a delay?</p></li>
<li><p>What happened on June 13 2013? Display the spatial pattern of delays,
and then use Google to cross-reference with the weather.</p></li>
</ol>
</div>
<div id="other-implementations" class="section level3" number="13.4.7">
<h3><span class="header-section-number">13.4.7</span> Other implementations</h3>
<p><code>base::merge()</code> can perform all four types of mutating join:</p>
<table>
<thead>
<tr class="header">
<th>dplyr</th>
<th>merge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>inner_join(x, y)</code></td>
<td><code>merge(x, y)</code></td>
</tr>
<tr class="even">
<td><code>left_join(x, y)</code></td>
<td><code>merge(x, y, all.x = TRUE)</code></td>
</tr>
<tr class="odd">
<td><code>right_join(x, y)</code></td>
<td><code>merge(x, y, all.y = TRUE)</code>,</td>
</tr>
<tr class="even">
<td><code>full_join(x, y)</code></td>
<td><code>merge(x, y, all.x = TRUE, all.y = TRUE)</code></td>
</tr>
</tbody>
</table>
<p>The advantages of the specific dplyr verbs is that they more clearly convey the intent of your code: the difference between the joins is really important but concealed in the arguments of <code>merge()</code>. dplyr’s joins are considerably faster and don’t mess with the order of the rows.</p>
<p>SQL is the inspiration for dplyr’s conventions, so the translation is straightforward:</p>
<table>
<thead>
<tr class="header">
<th>dplyr</th>
<th>SQL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>inner_join(x, y, by = "z")</code></td>
<td><code>SELECT * FROM x INNER JOIN y USING (z)</code></td>
</tr>
<tr class="even">
<td><code>left_join(x, y, by = "z")</code></td>
<td><code>SELECT * FROM x LEFT OUTER JOIN y USING (z)</code></td>
</tr>
<tr class="odd">
<td><code>right_join(x, y, by = "z")</code></td>
<td><code>SELECT * FROM x RIGHT OUTER JOIN y USING (z)</code></td>
</tr>
<tr class="even">
<td><code>full_join(x, y, by = "z")</code></td>
<td><code>SELECT * FROM x FULL OUTER JOIN y USING (z)</code></td>
</tr>
</tbody>
</table>
<p>Note that “INNER” and “OUTER” are optional, and often omitted.</p>
<p>Joining different variables between the tables, e.g. <code>inner_join(x, y, by = c("a" = "b"))</code> uses a slightly different syntax in SQL: <code>SELECT * FROM x INNER JOIN y ON x.a = y.b</code>. As this syntax suggests, SQL supports a wider range of join types than dplyr because you can connect the tables using constraints other than equality (sometimes called non-equijoins).</p>
</div>
</div>
<div id="filtering-joins" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> Filtering joins</h2>
<p>Filtering joins match observations in the same way as mutating joins, but affect the observations, not the variables. There are two types:</p>
<ul>
<li><code>semi_join(x, y)</code> <strong>keeps</strong> all observations in <code>x</code> that have a match in <code>y</code>.</li>
<li><code>anti_join(x, y)</code> <strong>drops</strong> all observations in <code>x</code> that have a match in <code>y</code>.</li>
</ul>
<p>Semi-joins are useful for matching filtered summary tables back to the original rows. For example, imagine you’ve found the top ten most popular destinations:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="relational-data.html#cb286-1" aria-hidden="true" tabindex="-1"></a>top_dest <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="relational-data.html#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(dest, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb286-3"><a href="relational-data.html#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb286-4"><a href="relational-data.html#cb286-4" aria-hidden="true" tabindex="-1"></a>top_dest</span>
<span id="cb286-5"><a href="relational-data.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 10 x 2</span></span>
<span id="cb286-6"><a href="relational-data.html#cb286-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   dest      n</span></span>
<span id="cb286-7"><a href="relational-data.html#cb286-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt; &lt;int&gt;</span></span>
<span id="cb286-8"><a href="relational-data.html#cb286-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 ORD   17283</span></span>
<span id="cb286-9"><a href="relational-data.html#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 ATL   17215</span></span>
<span id="cb286-10"><a href="relational-data.html#cb286-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 LAX   16174</span></span>
<span id="cb286-11"><a href="relational-data.html#cb286-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 BOS   15508</span></span>
<span id="cb286-12"><a href="relational-data.html#cb286-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 MCO   14082</span></span>
<span id="cb286-13"><a href="relational-data.html#cb286-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 CLT   14064</span></span>
<span id="cb286-14"><a href="relational-data.html#cb286-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 4 more rows</span></span></code></pre></div>
<p>Now you want to find each flight that went to one of those destinations. You could construct a filter yourself:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="relational-data.html#cb287-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb287-2"><a href="relational-data.html#cb287-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dest <span class="sc">%in%</span> top_dest<span class="sc">$</span>dest)</span>
<span id="cb287-3"><a href="relational-data.html#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 141,145 x 19</span></span>
<span id="cb287-4"><a href="relational-data.html#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb287-5"><a href="relational-data.html#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb287-6"><a href="relational-data.html#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1      542            540         2      923            850</span></span>
<span id="cb287-7"><a href="relational-data.html#cb287-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1      554            600        -6      812            837</span></span>
<span id="cb287-8"><a href="relational-data.html#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1      554            558        -4      740            728</span></span>
<span id="cb287-9"><a href="relational-data.html#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1      555            600        -5      913            854</span></span>
<span id="cb287-10"><a href="relational-data.html#cb287-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1      557            600        -3      838            846</span></span>
<span id="cb287-11"><a href="relational-data.html#cb287-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1      558            600        -2      753            745</span></span>
<span id="cb287-12"><a href="relational-data.html#cb287-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 141,139 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb287-13"><a href="relational-data.html#cb287-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb287-14"><a href="relational-data.html#cb287-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>But it’s difficult to extend that approach to multiple variables. For example, imagine that you’d found the 10 days with highest average delays. How would you construct the filter statement that used <code>year</code>, <code>month</code>, and <code>day</code> to match it back to <code>flights</code>?</p>
<p>Instead you can use a semi-join, which connects the two tables like a mutating join, but instead of adding new columns, only keeps the rows in <code>x</code> that have a match in <code>y</code>:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="relational-data.html#cb288-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb288-2"><a href="relational-data.html#cb288-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(top_dest)</span>
<span id="cb288-3"><a href="relational-data.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Joining, by = &quot;dest&quot;</span></span>
<span id="cb288-4"><a href="relational-data.html#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 141,145 x 19</span></span>
<span id="cb288-5"><a href="relational-data.html#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time</span></span>
<span id="cb288-6"><a href="relational-data.html#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;</span></span>
<span id="cb288-7"><a href="relational-data.html#cb288-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2013     1     1      542            540         2      923            850</span></span>
<span id="cb288-8"><a href="relational-data.html#cb288-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2013     1     1      554            600        -6      812            837</span></span>
<span id="cb288-9"><a href="relational-data.html#cb288-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2013     1     1      554            558        -4      740            728</span></span>
<span id="cb288-10"><a href="relational-data.html#cb288-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2013     1     1      555            600        -5      913            854</span></span>
<span id="cb288-11"><a href="relational-data.html#cb288-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2013     1     1      557            600        -3      838            846</span></span>
<span id="cb288-12"><a href="relational-data.html#cb288-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2013     1     1      558            600        -2      753            745</span></span>
<span id="cb288-13"><a href="relational-data.html#cb288-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 141,139 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,</span></span>
<span id="cb288-14"><a href="relational-data.html#cb288-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></span>
<span id="cb288-15"><a href="relational-data.html#cb288-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></span></code></pre></div>
<p>Graphically, a semi-join looks like this:</p>
<p><img src="diagrams/join-semi.png" style="display: block; margin: auto;" /></p>
<p>Only the existence of a match is important; it doesn’t matter which observation is matched. This means that filtering joins never duplicate rows like mutating joins do:</p>
<p><img src="diagrams/join-semi-many.png" style="display: block; margin: auto;" /></p>
<p>The inverse of a semi-join is an anti-join. An anti-join keeps the rows that <em>don’t</em> have a match:</p>
<p><img src="diagrams/join-anti.png" style="display: block; margin: auto;" /></p>
<p>Anti-joins are useful for diagnosing join mismatches. For example, when connecting <code>flights</code> and <code>planes</code>, you might be interested to know that there are many <code>flights</code> that don’t have a match in <code>planes</code>:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="relational-data.html#cb289-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span></span>
<span id="cb289-2"><a href="relational-data.html#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(planes, <span class="at">by =</span> <span class="st">&quot;tailnum&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb289-3"><a href="relational-data.html#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tailnum, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb289-4"><a href="relational-data.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 722 x 2</span></span>
<span id="cb289-5"><a href="relational-data.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   tailnum     n</span></span>
<span id="cb289-6"><a href="relational-data.html#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt;</span></span>
<span id="cb289-7"><a href="relational-data.html#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 &lt;NA&gt;     2512</span></span>
<span id="cb289-8"><a href="relational-data.html#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 N725MQ    575</span></span>
<span id="cb289-9"><a href="relational-data.html#cb289-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 N722MQ    513</span></span>
<span id="cb289-10"><a href="relational-data.html#cb289-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 N723MQ    507</span></span>
<span id="cb289-11"><a href="relational-data.html#cb289-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 N713MQ    483</span></span>
<span id="cb289-12"><a href="relational-data.html#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 N735MQ    396</span></span>
<span id="cb289-13"><a href="relational-data.html#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 716 more rows</span></span></code></pre></div>
<div id="exercises-31" class="section level3" number="13.5.1">
<h3><span class="header-section-number">13.5.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>What does it mean for a flight to have a missing <code>tailnum</code>? What do the
tail numbers that don’t have a matching record in <code>planes</code> have in common?
(Hint: one variable explains ~90% of the problems.)</p></li>
<li><p>Filter flights to only show flights with planes that have flown at least 100
flights.</p></li>
<li><p>Combine <code>fueleconomy::vehicles</code> and <code>fueleconomy::common</code> to find only the
records for the most common models.</p></li>
<li><p>Find the 48 hours (over the course of the whole year) that have the worst
delays. Cross-reference it with the <code>weather</code> data. Can you see any
patterns?</p></li>
<li><p>What does <code>anti_join(flights, airports, by = c("dest" = "faa"))</code> tell you?
What does <code>anti_join(airports, flights, by = c("faa" = "dest"))</code> tell you?</p></li>
<li><p>You might expect that there’s an implicit relationship between plane
and airline, because each plane is flown by a single airline. Confirm
or reject this hypothesis using the tools you’ve learned above.</p></li>
</ol>
</div>
</div>
<div id="join-problems" class="section level2" number="13.6">
<h2><span class="header-section-number">13.6</span> Join problems</h2>
<p>The data you’ve been working with in this chapter has been cleaned up so that you’ll have as few problems as possible. Your own data is unlikely to be so nice, so there are a few things that you should do with your own data to make your joins go smoothly.</p>
<ol style="list-style-type: decimal">
<li><p>Start by identifying the variables that form the primary key in each table.
You should usually do this based on your understanding of the data, not
empirically by looking for a combination of variables that give a
unique identifier. If you just look for variables without thinking about
what they mean, you might get (un)lucky and find a combination that’s
unique in your current data but the relationship might not be true in
general.</p>
<p>For example, the altitude and longitude uniquely identify each airport,
but they are not good identifiers!</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="relational-data.html#cb290-1" aria-hidden="true" tabindex="-1"></a>airports <span class="sc">%&gt;%</span> <span class="fu">count</span>(alt, lon) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb290-2"><a href="relational-data.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 0 x 3</span></span>
<span id="cb290-3"><a href="relational-data.html#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 3 variables: alt &lt;dbl&gt;, lon &lt;dbl&gt;, n &lt;int&gt;</span></span></code></pre></div></li>
<li><p>Check that none of the variables in the primary key are missing. If
a value is missing then it can’t identify an observation!</p></li>
<li><p>Check that your foreign keys match primary keys in another table. The
best way to do this is with an <code>anti_join()</code>. It’s common for keys
not to match because of data entry errors. Fixing these is often a lot of
work.</p>
<p>If you do have missing keys, you’ll need to be thoughtful about your
use of inner vs. outer joins, carefully considering whether or not you
want to drop rows that don’t have a match.</p></li>
</ol>
<p>Be aware that simply checking the number of rows before and after the join is not sufficient to ensure that your join has gone smoothly. If you have an inner join with duplicate keys in both tables, you might get unlucky as the number of dropped rows might exactly equal the number of duplicated rows!</p>
</div>
<div id="set-operations" class="section level2" number="13.7">
<h2><span class="header-section-number">13.7</span> Set operations</h2>
<p>The final type of two-table verb are the set operations. Generally, I use these the least frequently, but they are occasionally useful when you want to break a single complex filter into simpler pieces. All these operations work with a complete row, comparing the values of every variable. These expect the <code>x</code> and <code>y</code> inputs to have the same variables, and treat the observations like sets:</p>
<ul>
<li><code>intersect(x, y)</code>: return only observations in both <code>x</code> and <code>y</code>.</li>
<li><code>union(x, y)</code>: return unique observations in <code>x</code> and <code>y</code>.</li>
<li><code>setdiff(x, y)</code>: return observations in <code>x</code>, but not in <code>y</code>.</li>
</ul>
<p>Given this simple data:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="relational-data.html#cb291-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb291-2"><a href="relational-data.html#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb291-3"><a href="relational-data.html#cb291-3" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span>,  <span class="dv">1</span>,</span>
<span id="cb291-4"><a href="relational-data.html#cb291-4" aria-hidden="true" tabindex="-1"></a>   <span class="dv">2</span>,  <span class="dv">1</span></span>
<span id="cb291-5"><a href="relational-data.html#cb291-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb291-6"><a href="relational-data.html#cb291-6" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb291-7"><a href="relational-data.html#cb291-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>x, <span class="sc">~</span>y,</span>
<span id="cb291-8"><a href="relational-data.html#cb291-8" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span>,  <span class="dv">1</span>,</span>
<span id="cb291-9"><a href="relational-data.html#cb291-9" aria-hidden="true" tabindex="-1"></a>   <span class="dv">1</span>,  <span class="dv">2</span></span>
<span id="cb291-10"><a href="relational-data.html#cb291-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The four possibilities are:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="relational-data.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(df1, df2)</span>
<span id="cb292-2"><a href="relational-data.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 x 2</span></span>
<span id="cb292-3"><a href="relational-data.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x     y</span></span>
<span id="cb292-4"><a href="relational-data.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb292-5"><a href="relational-data.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1     1</span></span>
<span id="cb292-6"><a href="relational-data.html#cb292-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-7"><a href="relational-data.html#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we get 3 rows, not 4</span></span>
<span id="cb292-8"><a href="relational-data.html#cb292-8" aria-hidden="true" tabindex="-1"></a><span class="fu">union</span>(df1, df2)</span>
<span id="cb292-9"><a href="relational-data.html#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 x 2</span></span>
<span id="cb292-10"><a href="relational-data.html#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x     y</span></span>
<span id="cb292-11"><a href="relational-data.html#cb292-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb292-12"><a href="relational-data.html#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1     1</span></span>
<span id="cb292-13"><a href="relational-data.html#cb292-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2     1</span></span>
<span id="cb292-14"><a href="relational-data.html#cb292-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     1     2</span></span>
<span id="cb292-15"><a href="relational-data.html#cb292-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-16"><a href="relational-data.html#cb292-16" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(df1, df2)</span>
<span id="cb292-17"><a href="relational-data.html#cb292-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 x 2</span></span>
<span id="cb292-18"><a href="relational-data.html#cb292-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x     y</span></span>
<span id="cb292-19"><a href="relational-data.html#cb292-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb292-20"><a href="relational-data.html#cb292-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     2     1</span></span>
<span id="cb292-21"><a href="relational-data.html#cb292-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-22"><a href="relational-data.html#cb292-22" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(df2, df1)</span>
<span id="cb292-23"><a href="relational-data.html#cb292-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 x 2</span></span>
<span id="cb292-24"><a href="relational-data.html#cb292-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x     y</span></span>
<span id="cb292-25"><a href="relational-data.html#cb292-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb292-26"><a href="relational-data.html#cb292-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     1     2</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidy-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="strings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r4ds/edit/master/relational-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
